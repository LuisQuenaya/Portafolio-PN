<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Unidad 2 ‚Äî Portafolio Completo</title>

    <!-- MathJax para f√≥rmulas matem√°ticas -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    
    <!-- Chart.js para gr√°ficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Estilos con colores azul, blanco y degradados -->
    <style>
        :root {
            --azul-primario: #0066cc;
            --azul-secundario: #003366;
            --azul-oscuro: #001f3f;
            --azul-degradado: linear-gradient(135deg, #0066cc, #0044aa);
            --degradado-blanco: linear-gradient(135deg, #ffffff, #f0f8ff);
            --degradado-azul-claro: linear-gradient(135deg, #e6f2ff, #f0f8ff);
            --blanco: #ffffff;
            --blanco-hueso: #f8f9fa;
            --gris-claro: #eef2f7;
            --gris-medio: #6c757d;
            --gris-oscuro: #2c3e50;
            --sombra: rgba(0, 51, 102, 0.15);
            --sombra-fuerte: rgba(0, 51, 102, 0.25);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(180deg, var(--gris-claro) 0%, var(--blanco) 100%);
            color: var(--gris-oscuro);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* Header con degradado azul */
        .header {
            background: var(--azul-degradado);
            color: var(--blanco);
            padding: 2rem;
            text-align: center;
            box-shadow: 0 4px 20px var(--sombra-fuerte);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 8px rgba(0,0,0,0.2);
            position: relative;
        }
        
        .header h2 {
            font-size: 1.2rem;
            font-weight: 300;
            opacity: 0.9;
            position: relative;
        }
        
        /* Navegaci√≥n por pesta√±as */
        .nav-container {
            background: var(--blanco);
            box-shadow: 0 2px 15px var(--sombra);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-tabs {
            display: flex;
            overflow-x: auto;
            padding: 0;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .nav-tab {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--gris-oscuro);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
        }
        
        .nav-tab:hover {
            background: var(--gris-claro);
            color: var(--azul-primario);
        }
        
        .nav-tab.active {
            background: var(--blanco);
            border-bottom: 3px solid var(--azul-primario);
            color: var(--azul-primario);
            font-weight: 600;
        }
        
        /* Contenido principal */
        .main-content {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        /* Contenedor de actividad */
        .activity-container {
            background: var(--degradado-blanco);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 30px var(--sombra);
            border: 1px solid rgba(0, 102, 204, 0.1);
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .activity-container h2 {
            color: var(--azul-secundario);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--azul-primario);
            font-size: 1.8rem;
        }
        
        /* Botones */
        .btn-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }
        
        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background: var(--azul-primario);
            color: var(--blanco);
        }
        
        .btn-primary:hover {
            background: var(--azul-secundario);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 102, 204, 0.3);
        }
        
        .btn-secondary {
            background: var(--blanco);
            color: var(--azul-primario);
            border: 2px solid var(--azul-primario);
        }
        
        .btn-secondary:hover {
            background: var(--gris-claro);
            transform: translateY(-2px);
        }
        
        /* Secciones */
        .section {
            background: var(--blanco);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: 0 4px 15px var(--sombra);
            border-left: 4px solid var(--azul-primario);
        }
        
        .section h3 {
            color: var(--azul-secundario);
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }
        
        /* F√≥rmulas */
        .formula-container {
            background: linear-gradient(135deg, #e6f2ff, #f0f8ff);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 1px solid rgba(0, 102, 204, 0.2);
            box-shadow: 0 2px 10px rgba(0, 102, 204, 0.1);
        }
        
        .formula {
            font-size: 1.1rem;
            margin: 1rem 0;
            padding: 1rem;
            background: var(--blanco);
            border-radius: 6px;
            border-left: 3px solid var(--azul-primario);
            overflow-x: auto;
        }
        
        /* Tablas */
        .table-container {
            overflow-x: auto;
            margin: 1.5rem 0;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            background: var(--blanco);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px var(--sombra);
        }
        
        .table th {
            background: linear-gradient(135deg, var(--azul-primario), var(--azul-secundario));
            color: var(--blanco);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }
        
        .table td {
            padding: 0.8rem 1rem;
            border-bottom: 1px solid var(--gris-claro);
        }
        
        .table tr:hover {
            background: var(--gris-claro);
        }
        
        /* C√≥digo */
        .code-container {
            background: var(--azul-oscuro);
            border-radius: 8px;
            margin: 1.5rem 0;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }
        
        .code-header {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.8rem 1rem;
            color: var(--blanco);
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .code {
            padding: 1.5rem;
            color: #e6fbff;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            overflow-x: auto;
            white-space: pre-wrap;
            tab-size: 4;
        }
        
        /* Simulaciones */
        .simulation-container {
            background: linear-gradient(135deg, #ffffff, #f8fbff);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid var(--azul-primario);
            box-shadow: 0 8px 25px var(--sombra);
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .input-field {
            padding: 0.8rem 1rem;
            border: 2px solid var(--gris-claro);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--blanco);
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--azul-primario);
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.2);
        }
        
        .results {
            background: var(--blanco);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px solid var(--gris-claro);
            max-height: 400px;
            overflow-y: auto;
        }
        
        /* Canvas para gr√°ficos */
        .canvas-container {
            background: var(--blanco);
            border-radius: 8px;
            padding: 1rem;
            margin: 1.5rem 0;
            box-shadow: 0 4px 15px var(--sombra);
        }
        
        canvas {
            display: block;
            max-width: 100%;
            height: auto;
            border-radius: 6px;
        }
        
        /* Footer */
        .footer {
            background: var(--azul-secundario);
            color: var(--blanco);
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .nav-tabs {
                padding: 0 0.5rem;
            }
            
            .nav-tab {
                padding: 0.8rem 1rem;
                font-size: 0.9rem;
            }
            
            .activity-container {
                padding: 1.5rem;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>Programaci√≥n Num√©rica - Unidad 2</h1>
        <h2>Portafolio Digital Completo con Simulaciones Interactivas</h2>
    </div>

    <!-- Navegaci√≥n -->
    <div class="nav-container">
        <div class="nav-tabs" id="navTabs">
            <button class="nav-tab active" onclick="showActivity('menu')">üè† Inicio</button>
            <button class="nav-tab" onclick="showActivity('act1')">1. Bisecci√≥n</button>
            <button class="nav-tab" onclick="showActivity('act2')">2. Secante</button>
            <button class="nav-tab" onclick="showActivity('act3')">3. Punto Fijo</button>
            <button class="nav-tab" onclick="showActivity('act4')">4. Regula Falsi</button>
            <button class="nav-tab" onclick="showActivity('act5')">5. Newton-Raphson</button>
            <button class="nav-tab" onclick="showActivity('act6')">6. √çndice H</button>
            <button class="nav-tab" onclick="showActivity('act7')">7. Gradiente</button>
            <button class="nav-tab" onclick="showActivity('act8')">8. Pseudoinverso vs GD</button>
            <button class="nav-tab" onclick="showActivity('act9')">9. Caramelos</button>
            <button class="nav-tab" onclick="showActivity('act10')">10. Algoritmo Demons</button>
            <button class="nav-tab" onclick="showActivity('act11')">11. Diferenciaci√≥n</button>
            <button class="nav-tab" onclick="showActivity('act12')">12. Interpolaci√≥n</button>
            <button class="nav-tab" onclick="showActivity('act13')">13. Apache JMeter</button>
            <button class="nav-tab" onclick="showActivity('act14')">14. Poster Papa</button>
            <button class="nav-tab" onclick="showActivity('act15')">15. Eigenvalores</button>
            <button class="nav-tab" onclick="showActivity('act16')">16. Cadenas Markov</button>
            <button class="nav-tab" onclick="showActivity('act17')">17. Libro Completo</button>
        </div>
    </div>

    <!-- Contenido Principal -->
    <div class="main-content">
        
        <!-- Men√∫ Principal -->
        <div id="menu" class="activity-content" style="display: block;">
            <div class="activity-container">
                <h2>üìö Portafolio Digital - Unidad 2</h2>
                <p style="text-align: center; margin-bottom: 2rem; font-size: 1.1rem;">
                    Selecciona una actividad para ver su contenido te√≥rico, f√≥rmulas, c√≥digo fuente y simulaciones interactivas.
                </p>
                
                <div class="grid-activities">
                    <!-- Actividades del 1 al 5 -->
                    <div class="section" onclick="showActivity('act1')" style="cursor: pointer;">
                        <h3>1. M√©todo de Bisecci√≥n</h3>
                        <p>Encuentra ra√≠ces mediante divisi√≥n sucesiva de intervalos.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act2')" style="cursor: pointer;">
                        <h3>2. M√©todo de la Secante</h3>
                        <p>Aproximaci√≥n de ra√≠ces usando rectas secantes.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act3')" style="cursor: pointer;">
                        <h3>3. M√©todo del Punto Fijo</h3>
                        <p>Transforma b√∫squeda de ra√≠ces en puntos fijos.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act4')" style="cursor: pointer;">
                        <h3>4. M√©todo de Regula Falsi</h3>
                        <p>M√©todo de falsa posici√≥n h√≠brido.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act5')" style="cursor: pointer;">
                        <h3>5. Newton-Raphson</h3>
                        <p>M√©todo iterativo r√°pido con derivadas.</p>
                    </div>
                    
                    <!-- Actividades del 6 al 17 -->
                    <div class="section" onclick="showActivity('act6')" style="cursor: pointer;">
                        <h3>6. √çndice H</h3>
                        <p>M√©trica bibliom√©trica para impacto cient√≠fico.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act7')" style="cursor: pointer;">
                        <h3>7. Gradiente de una Funci√≥n</h3>
                        <p>Vector de m√°ximo crecimiento y descenso.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act8')" style="cursor: pointer;">
                        <h3>8. Pseudoinverso vs Gradiente</h3>
                        <p>Comparaci√≥n en regresi√≥n lineal.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act9')" style="cursor: pointer;">
                        <h3>9. Simulaci√≥n del Juego de Caramelos</h3>
                        <p>Simulaci√≥n estoc√°stica cooperativa.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act10')" style="cursor: pointer;">
                        <h3>10. Algoritmo Demons</h3>
                        <p>Para registro de im√°genes m√©dicas.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act11')" style="cursor: pointer;">
                        <h3>11. Diferenciaci√≥n Num√©rica</h3>
                        <p>F√≥rmulas de diferencias finitas.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act12')" style="cursor: pointer;">
                        <h3>12. Interpolaci√≥n Num√©rica</h3>
                        <p>M√©todos de interpolaci√≥n matem√°tica.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act13')" style="cursor: pointer;">
                        <h3>13. Apache JMeter</h3>
                        <p>Pruebas de rendimiento web.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act14')" style="cursor: pointer;">
                        <h3>14. Poster Cient√≠fico</h3>
                        <p>Producci√≥n de papa en Per√∫.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act15')" style="cursor: pointer;">
                        <h3>15. Eigenvalores y Eigenvectores</h3>
                        <p>An√°lisis de transformaciones lineales.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act16')" style="cursor: pointer;">
                        <h3>16. Cadenas de Markov</h3>
                        <p>Procesos estoc√°sticos discretos.</p>
                    </div>
                    
                    <div class="section" onclick="showActivity('act17')" style="cursor: pointer;">
                        <h3>17. Libro de la Unidad</h3>
                        <p>Compilaci√≥n completa del contenido.</p>
                    </div>
                </div>
                
                <style>
                    .grid-activities {
                        display: grid;
                        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                        gap: 1.5rem;
                        margin-top: 2rem;
                    }
                    
                    .grid-activities .section {
                        transition: transform 0.3s ease, box-shadow 0.3s ease;
                    }
                    
                    .grid-activities .section:hover {
                        transform: translateY(-5px);
                        box-shadow: 0 10px 25px var(--sombra-fuerte);
                    }
                </style>
            </div>
        </div>

        <!-- ACTIVIDAD 6: √çNDICE H (COMPLETA CON TODA LA INFORMACI√ìN) -->
        <div id="act6" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 6 ‚Äî √çndice H</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('Indice_h.pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-secondary" onclick="calcularIndiceHAvanzado()">üßÆ Calculadora Avanzada</button>
                </div>

                <!-- Introducci√≥n -->
                <div class="section">
                    <h3>üìò Introducci√≥n</h3>
                    <p>El <strong>√≠ndice H</strong> (o √≠ndice de Hirsch) es un indicador cuantitativo utilizado para medir la <strong>productividad cient√≠fica</strong> y el <strong>impacto</strong> de un investigador, grupo de investigaci√≥n o instituci√≥n acad√©mica.</p>
                    
                    <div class="formula-container">
                        <h4>Definici√≥n Matem√°tica</h4>
                        <div class="formula">
                            Un investigador tiene √≠ndice $h$ si $h$ de sus publicaciones tienen al menos $h$ citaciones cada una.
                        </div>
                        <div class="formula">
                            Formalmente: $h = \max\{i \in \mathbb{N} : c_i \geq i\}$
                        </div>
                        <p>Donde $c_i$ es el n√∫mero de citas de la i-√©sima publicaci√≥n ordenada de mayor a menor.</p>
                    </div>
                </div>

                <!-- F√≥rmulas del √çndice H -->
                <div class="section">
                    <h3>üìê F√≥rmulas y M√©tricas Relacionadas</h3>
                    
                    <div class="formula">
                        <strong>√çndice H normalizado por a√±os:</strong>
                        $$ h_{norm} = \frac{h}{A} $$
                        donde $A$ es el n√∫mero de a√±os desde la primera publicaci√≥n.
                    </div>
                    
                    <div class="formula">
                        <strong>√çndice g (de Egghe):</strong>
                        $$ g = \max\left\{k : \sum_{i=1}^{k} c_i \geq k^2\right\} $$
                    </div>
                    
                    <div class="formula">
                        <strong>√çndice m (mediana):</strong>
                        $$ m = \frac{h}{A} $$
                        Considerado "bueno" si $m \geq 1$
                    </div>
                    
                    <div class="formula">
                        <strong>√çndice H ponderado:</strong>
                        $$ h_w = \sqrt{\sum_{i=1}^{N} w_i \cdot \min(c_i, h)} $$
                        donde $w_i$ son pesos seg√∫n el tipo de publicaci√≥n.
                    </div>
                </div>

                <!-- Tablas de Autores -->
                <div class="section">
                    <h3>üìä Autores Internacionales y su √çndice H</h3>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Autor</th>
                                    <th>Investigaci√≥n Principal</th>
                                    <th>N¬∞ Publicaciones</th>
                                    <th>√çndice H</th>
                                    <th>Enlace</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Grau, √Ängela</td>
                                    <td>M√©todos secantes para sistemas no lineales</td>
                                    <td>12</td>
                                    <td>9</td>
                                    <td><a href="https://www.scopus.com/authid/detail.uri?authorId=36545025500" target="_blank">Scopus</a></td>
                                </tr>
                                <tr>
                                    <td>D√≠az-Barrero, Jos√© Luis</td>
                                    <td>Convergencia de m√©todos iterativos</td>
                                    <td>41</td>
                                    <td>12</td>
                                    <td><a href="https://www.scopus.com/authid/detail.uri?authorId=6602720000" target="_blank">Scopus</a></td>
                                </tr>
                                <tr>
                                    <td>Argyros, Ioannis K.</td>
                                    <td>Algoritmos para problemas no lineales</td>
                                    <td>931</td>
                                    <td>33</td>
                                    <td><a href="https://www.scopus.com/authid/detail.uri?authorId=7004530784" target="_blank">Scopus</a></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Tabla de Docentes -->
                <div class="section">
                    <h3>üë®‚Äçüè´ √çndice H de Docentes - Facultad de Ingenier√≠a Estad√≠stica e Inform√°tica</h3>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Docente</th>
                                    <th>√çndice H</th>
                                    <th>N¬∞ Publicaciones</th>
                                    <th>Enlace Scopus</th>
                                </tr>
                            </thead>
                            <tbody id="docentesTable">
                                <!-- Los datos se cargan con JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Simulaci√≥n Interactiva -->
                <div class="simulation-container">
                    <h3>üéÆ Calculadora Avanzada de √çndice H</h3>
                    
                    <div class="input-group">
                        <input type="text" id="citasInput" class="input-field" 
                               placeholder="Ingresa citas separadas por comas. Ej: 25,12,8,5,3,1"
                               value="25,12,8,5,3,1,0,0">
                        <input type="number" id="aniosInput" class="input-field" 
                               placeholder="A√±os de carrera" value="10" min="1" max="50">
                        <select id="tipoInvestigador" class="input-field">
                            <option value="1.0">Investigador Junior</option>
                            <option value="1.2">Investigador Senior</option>
                            <option value="1.5">Profesor Titular</option>
                            <option value="2.0">Investigador Principal</option>
                        </select>
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="calcularIndiceH()">Calcular √çndice H</button>
                        <button class="btn btn-secondary" onclick="generarCitasAleatorias()">Generar Citas Aleatorias</button>
                        <button class="btn btn-secondary" onclick="analizarTendencia()">An√°lisis de Tendencia</button>
                    </div>
                    
                    <div class="results" id="resultadosH">
                        <p style="color: var(--gris-medio);">Los resultados aparecer√°n aqu√≠...</p>
                    </div>
                    
                    <div class="canvas-container">
                        <canvas id="graficoH" width="800" height="400"></canvas>
                    </div>
                </div>

                <!-- C√≥digo de c√°lculo -->
                <div class="section">
                    <h3>üíª C√≥digo Python para C√°lculo del √çndice H</h3>
                    <div class="code-container">
                        <div class="code-header">
                            <span>h_index_calculator.py</span>
                            <button class="btn btn-secondary" onclick="copiarCodigo('codigoH')" style="padding: 0.3rem 0.8rem; font-size: 0.8rem;">Copiar</button>
                        </div>
                        <pre class="code" id="codigoH">import numpy as np
import matplotlib.pyplot as plt

def calcular_indice_h(citas):
    """
    Calcula el √≠ndice H de un investigador.
    
    Args:
        citas: Lista de citas por publicaci√≥n
        
    Returns:
        h: √çndice H
    """
    citas_ordenadas = sorted(citas, reverse=True)
    h = 0
    for i, c in enumerate(citas_ordenadas, 1):
        if c >= i:
            h = i
        else:
            break
    return h

def calcular_metricas_completas(citas, a√±os_carrera):
    """
    Calcula m√∫ltiples m√©tricas bibliom√©tricas.
    
    Returns:
        dict: Diccionario con todas las m√©tricas
    """
    citas_ordenadas = sorted(citas, reverse=True)
    h = calcular_indice_h(citas)
    
    # C√°lculo del √≠ndice g
    suma_acumulada = np.cumsum(citas_ordenadas)
    g = 0
    for i, suma in enumerate(suma_acumulada, 1):
        if suma >= i**2:
            g = i
    
    # C√°lculo del √≠ndice m
    m = h / a√±os_carrera if a√±os_carrera > 0 else 0
    
    # N√∫mero total de citas
    total_citas = sum(citas)
    
    # Promedio de citas por publicaci√≥n
    promedio = total_citas / len(citas) if citas else 0
    
    # Publicaciones con al menos h citas
    publicaciones_h = sum(1 for c in citas if c >= h)
    
    return {
        'h_index': h,
        'g_index': g,
        'm_index': m,
        'total_citas': total_citas,
        'promedio_citas': promedio,
        'publicaciones_h': publicaciones_h,
        'total_publicaciones': len(citas)
    }

# Ejemplo de uso
if __name__ == "__main__":
    # Datos de ejemplo
    citas_ejemplo = [25, 12, 8, 5, 3, 1, 0, 0]
    a√±os = 10
    
    metricas = calcular_metricas_completas(citas_ejemplo, a√±os)
    
    print("=== M√âTRICAS BIBLIOM√âTRICAS ===")
    print(f"√çndice H: {metricas['h_index']}")
    print(f"√çndice g: {metricas['g_index']}")
    print(f"√çndice m: {metricas['m_index']:.2f}")
    print(f"Total de citas: {metricas['total_citas']}")
    print(f"Promedio de citas: {metricas['promedio_citas']:.2f}")
    print(f"Publicaciones con ‚â•H citas: {metricas['publicaciones_h']}")
    print(f"Total de publicaciones: {metricas['total_publicaciones']}")
    
    # Clasificaci√≥n
    if metricas['m_index'] >= 1.0:
        print("\n‚úÖ Excelente productividad (m ‚â• 1.0)")
    elif metricas['m_index'] >= 0.5:
        print("\n‚ö†Ô∏è Productividad moderada (0.5 ‚â§ m < 1.0)")
    else:
        print("\nüìâ Productividad baja (m < 0.5)")</pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 7: GRADIENTE DE UNA FUNCI√ìN -->
        <div id="act7" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 7 ‚Äî Gradiente de una Funci√≥n</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('actividad_8.pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-primary" onclick="ejecutarDescensoGradienteCompleto()">üìâ Simular Descenso</button>
                </div>

                <!-- CONTENIDO TE√ìRICO COMPLETO -->
                <div class="section">
                    <h3>üìò Teor√≠a del Gradiente y Optimizaci√≥n</h3>
                    <p>El <strong>gradiente</strong> $\nabla f$ es un vector que apunta en la direcci√≥n de m√°ximo crecimiento de una funci√≥n escalar. En optimizaci√≥n, usamos el <strong>descenso del gradiente</strong> para encontrar m√≠nimos.</p>
                    
                    <div class="formula-container">
                        <h4>Definici√≥n Matem√°tica del Gradiente</h4>
                        <div class="formula">
                            $$ \nabla f(\mathbf{x}) = \begin{bmatrix} 
                            \frac{\partial f}{\partial x_1} \\ 
                            \frac{\partial f}{\partial x_2} \\ 
                            \vdots \\ 
                            \frac{\partial f}{\partial x_n} 
                            \end{bmatrix} $$
                        </div>
                    </div>
                    
                    <div class="formula-container">
                        <h4>Algoritmo de Descenso del Gradiente</h4>
                        <div class="formula">
                            $$ \mathbf{x}_{k+1} = \mathbf{x}_k - \alpha \nabla f(\mathbf{x}_k) $$
                            donde $\alpha$ es la tasa de aprendizaje.
                        </div>
                    </div>
                </div>

                <!-- APLICACIONES PR√ÅCTICAS -->
                <div class="section">
                    <h3>üîß Aplicaciones del Gradiente</h3>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Aplicaci√≥n</th>
                                    <th>Funci√≥n Objetivo</th>
                                    <th>Interpretaci√≥n del Gradiente</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Aprendizaje Autom√°tico</td>
                                    <td>$J(\theta) = \frac{1}{m}\sum L(h_\theta(x_i), y_i)$</td>
                                    <td>Direcci√≥n para reducir el error de predicci√≥n</td>
                                </tr>
                                <tr>
                                    <td>Procesamiento de Im√°genes</td>
                                    <td>$E(u) = \int_\Omega |\nabla u|^2 dx$</td>
                                    <td>Direcci√≥n del flujo de intensidad</td>
                                </tr>
                                <tr>
                                    <td>Finanzas</td>
                                    <td>$R(p) = \sum r_i p_i - \lambda p^T\Sigma p$</td>
                                    <td>Sensibilidad del portafolio a cada activo</td>
                                </tr>
                                <tr>
                                    <td>Ingenier√≠a</td>
                                    <td>$f(x) = \text{tensi√≥n}(x) - \text{resistencia}$</td>
                                    <td>Direcci√≥n de m√°ximo estr√©s en material</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- SIMULACI√ìN DE GRADIENTE -->
                <div class="simulation-container">
                    <h3>üéÆ Simulaci√≥n de Descenso del Gradiente</h3>
                    
                    <div class="input-group">
                        <select id="funcionGradiente" class="input-field">
                            <option value="quadratic">Funci√≥n Cuadr√°tica: f(x) = x¬≤</option>
                            <option value="rosenbrock">Funci√≥n de Rosenbrock</option>
                            <option value="beale">Funci√≥n de Beale</option>
                            <option value="himmelblau">Funci√≥n de Himmelblau</option>
                        </select>
                        <input type="number" id="x0Grad" class="input-field" 
                               placeholder="x inicial" value="2.0" step="0.1">
                        <input type="number" id="alphaGrad" class="input-field" 
                               placeholder="Tasa aprendizaje (Œ±)" value="0.1" step="0.01">
                        <input type="number" id="iterGrad" class="input-field" 
                               placeholder="Iteraciones" value="100" min="10">
                        <select id="tipoGradiente" class="input-field">
                            <option value="batch">Descenso Batch</option>
                            <option value="stochastic">Descenso Estoc√°stico</option>
                            <option value="momentum">Descenso con Momentum</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary" onclick="ejecutarDescensoGradienteCompleto()">
                        üöÄ Ejecutar Descenso del Gradiente
                    </button>
                    
                    <div class="results" id="resultadosGradiente">
                        <p style="color: var(--gris-medio);">Los resultados aparecer√°n aqu√≠...</p>
                    </div>
                    
                    <div class="canvas-container">
                        <canvas id="graficoGradiente" width="800" height="400"></canvas>
                    </div>
                </div>

                <!-- C√ìDIGO PYTHON -->
                <div class="section">
                    <h3>üíª Implementaci√≥n en Python</h3>
                    <div class="code-container">
                        <div class="code-header">
                            <span>gradient_descent.py</span>
                            <button class="btn btn-secondary" onclick="copiarCodigo('codigoGradiente')" style="padding: 0.3rem 0.8rem; font-size: 0.8rem;">Copiar</button>
                        </div>
                        <pre class="code" id="codigoGradiente">import numpy as np
import matplotlib.pyplot as plt

class GradientDescent:
    """Clase para implementar diferentes variantes de descenso del gradiente."""
    
    def __init__(self, f, grad_f):
        """
        Inicializa el optimizador.
        
        Par√°metros:
        -----------
        f : callable
            Funci√≥n objetivo f(x)
        grad_f : callable
            Gradiente de la funci√≥n ‚àáf(x)
        """
        self.f = f
        self.grad_f = grad_f
        self.history = []
    
    def batch_gradient_descent(self, x0, learning_rate=0.1, 
                               max_iter=1000, tol=1e-6):
        """Descenso del gradiente cl√°sico (batch)."""
        x = np.array(x0, dtype=float)
        
        for i in range(max_iter):
            # Calcular gradiente
            grad = self.grad_f(x)
            
            # Actualizar posici√≥n
            x_new = x - learning_rate * grad
            
            # Guardar historial
            self.history.append({
                'iteration': i,
                'x': x.copy(),
                'f(x)': self.f(x),
                'gradient': grad.copy(),
                'step': learning_rate
            })
            
            # Verificar convergencia
            if np.linalg.norm(x_new - x) < tol:
                break
            
            x = x_new
        
        return x
    
    def stochastic_gradient_descent(self, x0, learning_rate=0.1,
                                    max_iter=1000, batch_size=1):
        """Descenso del gradiente estoc√°stico (SGD)."""
        x = np.array(x0, dtype=float)
        
        for i in range(max_iter):
            # Para SGD, normalmente tendr√≠amos datos y calcular√≠amos
            # gradiente sobre un minibatch
            # Aqu√≠ simulamos con ruido
            grad = self.grad_f(x) + np.random.randn(*x.shape) * 0.1
            
            # Actualizar con tasa de aprendizaje decreciente
            lr = learning_rate / (1 + 0.01 * i)
            x = x - lr * grad
            
            self.history.append({
                'iteration': i,
                'x': x.copy(),
                'f(x)': self.f(x),
                'gradient': grad.copy(),
                'step': lr
            })
        
        return x
    
    def momentum_gradient_descent(self, x0, learning_rate=0.1,
                                  momentum=0.9, max_iter=1000):
        """Descenso del gradiente con momentum."""
        x = np.array(x0, dtype=float)
        velocity = np.zeros_like(x)
        
        for i in range(max_iter):
            grad = self.grad_f(x)
            
            # Actualizar velocidad (momentum)
            velocity = momentum * velocity - learning_rate * grad
            
            # Actualizar posici√≥n
            x = x + velocity
            
            self.history.append({
                'iteration': i,
                'x': x.copy(),
                'f(x)': self.f(x),
                'gradient': grad.copy(),
                'velocity': velocity.copy()
            })
        
        return x

# Funciones de prueba comunes
def quadratic_function(x):
    """Funci√≥n cuadr√°tica: f(x) = x^T A x + b^T x + c"""
    A = np.array([[2, 1], [1, 2]])
    b = np.array([1, -1])
    return 0.5 * x.T @ A @ x + b.T @ x + 3

def quadratic_gradient(x):
    A = np.array([[2, 1], [1, 2]])
    b = np.array([1, -1])
    return A @ x + b

def rosenbrock_function(x):
    """Funci√≥n de Rosenbrock: f(x,y) = (1-x)^2 + 100(y-x^2)^2"""
    return (1 - x[0])**2 + 100 * (x[1] - x[0]**2)**2

def rosenbrock_gradient(x):
    dx = -2*(1 - x[0]) - 400*x[0]*(x[1] - x[0]**2)
    dy = 200*(x[1] - x[0]**2)
    return np.array([dx, dy])

# Ejemplo de uso
if __name__ == "__main__":
    print("="*70)
    print("DESCENSO DEL GRADIENTE - EJEMPLO COMPLETO")
    print("="*70)
    
    # Crear optimizador para Rosenbrock
    optimizer = GradientDescent(rosenbrock_function, rosenbrock_gradient)
    
    # Punto inicial (lejos del m√≠nimo)
    x0 = np.array([-1.5, 2.0])
    
    print(f"\n1. Descenso Batch (tasa fija):")
    result_batch = optimizer.batch_gradient_descent(x0, learning_rate=0.001)
    print(f"   M√≠nimo encontrado: {result_batch}")
    print(f"   f(m√≠nimo) = {rosenbrock_function(result_batch):.6f}")
    print(f"   Iteraciones: {len(optimizer.history)}")
    
    # Visualizar
    fig, axes = plt.subplots(2, 2, figsize=(12, 10))
    
    # Extraer datos del historial
    iterations = [h['iteration'] for h in optimizer.history]
    f_values = [h['f(x)'] for h in optimizer.history]
    x_history = [h['x'] for h in optimizer.history]
    
    # Gr√°fico 1: Convergencia de f(x)
    axes[0, 0].semilogy(iterations, f_values, 'b-', linewidth=2)
    axes[0, 0].set_xlabel('Iteraci√≥n')
    axes[0, 0].set_ylabel('f(x) (log scale)')
    axes[0, 0].set_title('Convergencia de la Funci√≥n Objetivo')
    axes[0, 0].grid(True, alpha=0.3)
    
    # Gr√°fico 2: Trayectoria en el espacio 2D
    x_vals = [x[0] for x in x_history]
    y_vals = [x[1] for x in x_history]
    axes[0, 1].plot(x_vals, y_vals, 'ro-', markersize=3, linewidth=1)
    axes[0, 1].set_xlabel('x')
    axes[0, 1].set_ylabel('y')
    axes[0, 1].set_title('Trayectoria del Descenso')
    axes[0, 1].grid(True, alpha=0.3)
    
    # Gr√°fico 3: Magnitud del gradiente
    grad_norms = [np.linalg.norm(h['gradient']) for h in optimizer.history]
    axes[1, 0].semilogy(iterations, grad_norms, 'g-', linewidth=2)
    axes[1, 0].set_xlabel('Iteraci√≥n')
    axes[1, 0].set_ylabel('||‚àáf|| (log scale)')
    axes[1, 0].set_title('Magnitud del Gradiente')
    axes[1, 0].grid(True, alpha=0.3)
    
    # Gr√°fico 4: Comparaci√≥n de m√©todos
    # (aqu√≠ podr√≠amos comparar diferentes m√©todos)
    axes[1, 1].axis('off')
    axes[1, 1].text(0.5, 0.5, 
                   f'Convergencia exitosa\n'
                   f'Punto inicial: {x0}\n'
                   f'Punto final: {result_batch.round(4)}\n'
                   f'f(final) = {f_values[-1]:.6f}\n'
                   f'Iteraciones: {len(iterations)}',
                   ha='center', va='center',
                   fontsize=12,
                   bbox=dict(boxstyle="round,pad=0.3",
                           facecolor="lightblue",
                           alpha=0.5))
    
    plt.tight_layout()
    plt.show()</pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 8: PSEUDOINVERSO vs DESCENSO GRADIENTE -->
        <div id="act8" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 8 ‚Äî Pseudoinverso de Moore-Penrose vs Descenso de Gradiente</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('tarea de resumenes.pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-primary" onclick="simularComparacionRegresion()">üìä Comparar M√©todos</button>
                </div>

                <!-- RESUMEN DEL ESTUDIO -->
                <div class="section">
                    <h3>üìö Estudio Comparativo en Regresi√≥n Lineal</h3>
                    <p><strong>Problema:</strong> Resolver $\min_{\mathbf{w}} \|\mathbf{X}\mathbf{w} - \mathbf{y}\|_2^2$</p>
                    
                    <div class="formula-container">
                        <h4>Soluci√≥n Anal√≠tica vs. Iterativa</h4>
                        <div class="formula">
                            <strong>Pseudoinverso (soluci√≥n exacta):</strong>
                            $$ \mathbf{w}_{MP} = \mathbf{X}^+ \mathbf{y} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y} $$
                        </div>
                        <div class="formula">
                            <strong>Descenso de Gradiente (soluci√≥n iterativa):</strong>
                            $$ \mathbf{w}_{k+1} = \mathbf{w}_k - \alpha \nabla J(\mathbf{w}_k) $$
                            $$ \nabla J(\mathbf{w}) = \frac{2}{n}\mathbf{X}^T(\mathbf{X}\mathbf{w} - \mathbf{y}) $$
                        </div>
                    </div>
                </div>

                <!-- COMPARATIVA DETALLADA -->
                <div class="section">
                    <h3>‚öñÔ∏è An√°lisis Comparativo Detallado</h3>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Criterio</th>
                                    <th>Pseudoinverso de Moore-Penrose</th>
                                    <th>Descenso de Gradiente</th>
                                    <th>Vencedor</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Precisi√≥n</strong></td>
                                    <td>Exacta (hasta precisi√≥n num√©rica)</td>
                                    <td>Aproximada (depende de convergencia)</td>
                                    <td>‚úÖ Pseudoinverso</td>
                                </tr>
                                <tr>
                                    <td><strong>Velocidad (n peque√±o)</strong></td>
                                    <td>R√°pida (soluci√≥n directa)</td>
                                    <td>Lenta (muchas iteraciones)</td>
                                    <td>‚úÖ Pseudoinverso</td>
                                </tr>
                                <tr>
                                    <td><strong>Velocidad (n grande)</strong></td>
                                    <td>Lenta ($O(nd^2 + d^3)$)</td>
                                    <td>R√°pida ($O(nd)$ por iteraci√≥n)</td>
                                    <td>‚úÖ Gradiente</td>
                                </tr>
                                <tr>
                                    <td><strong>Memoria</strong></td>
                                    <td>Alta ($O(d^2)$ para $X^TX$)</td>
                                    <td>Baja ($O(d)$)</td>
                                    <td>‚úÖ Gradiente</td>
                                </tr>
                                <tr>
                                    <td><strong>Estabilidad Num√©rica</strong></td>
                                    <td>Sensible a $\kappa(X)$</td>
                                    <td>Robusta (con regularizaci√≥n)</td>
                                    <td>‚úÖ Gradiente</td>
                                </tr>
                                <tr>
                                    <td><strong>Paralelizaci√≥n</strong></td>
                                    <td>Limitada</td>
                                    <td>Alta (SGD, minibatch)</td>
                                    <td>‚úÖ Gradiente</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- SIMULACI√ìN COMPARATIVA -->
                <div class="simulation-container">
                    <h3>üéÆ Simulaci√≥n Comparativa</h3>
                    
                    <div class="input-group">
                        <input type="number" id="nMuestras" class="input-field" 
                               placeholder="N√∫mero de muestras (n)" value="1000">
                        <input type="number" id="dCaracteristicas" class="input-field" 
                               placeholder="Caracter√≠sticas (d)" value="10">
                        <input type="number" id="ruidoData" class="input-field" 
                               placeholder="Ruido (%)" value="10" step="5">
                        <input type="number" id="condicionNum" class="input-field" 
                               placeholder="N√∫mero de condici√≥n" value="100">
                        <select id="metodoOptim" class="input-field">
                            <option value="comparar">Comparar Ambos</option>
                            <option value="pseudoinverso">Solo Pseudoinverso</option>
                            <option value="gradiente">Solo Gradiente</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary" onclick="simularComparacionRegresion()">
                        ‚ö° Ejecutar Comparaci√≥n
                    </button>
                    
                    <div class="results" id="resultadosComparacion">
                        <p style="color: var(--gris-medio);">Los resultados aparecer√°n aqu√≠...</p>
                    </div>
                    
                    <div class="canvas-container">
                        <canvas id="graficoComparacion" width="800" height="400"></canvas>
                    </div>
                </div>

                <!-- CONCLUSI√ìN -->
                <div class="section">
                    <h3>üéØ Conclusiones y Recomendaciones</h3>
                    
                    <div class="formula-container">
                        <h4>Reglas de Decisi√≥n</h4>
                        <ol>
                            <li><strong>$n < 1000$ y $d < 100$:</strong> Usar Pseudoinverso (exactitud)</li>
                            <li><strong>$n > 10000$ o $d > 1000$:</strong> Usar SGD (escalabilidad)</li>
                            <li><strong>$\kappa(X) > 10^6$:</strong> A√±adir regularizaci√≥n L2</li>
                            <li><strong>Recursos limitados:</strong> Usar minibatch SGD</li>
                            <li><strong>Precisi√≥n cr√≠tica:</strong> Pseudoinverso con SVD</li>
                        </ol>
                    </div>
                    
                    <div class="formula">
                        <strong>F√≥rmula h√≠brida recomendada:</strong>
                        $$ \mathbf{w}_{opt} = \lambda \mathbf{w}_{MP} + (1-\lambda) \mathbf{w}_{SGD} $$
                        donde $\lambda$ balancea exactitud vs. escalabilidad.
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 9: SIMULACI√ìN JUEGO DE CARAMELOS -->
        <div id="act9" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 9 ‚Äî Simulaci√≥n Cooperativa: Juego de Caramelos</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('Dinamica (2).pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-primary" onclick="ejecutarSimulacionCaramelos()">üç¨ Iniciar Simulaci√≥n</button>
                </div>

                <!-- DESCRIPCI√ìN DEL JUEGO -->
                <div class="section">
                    <h3>üéÆ Configuraci√≥n del Juego</h3>
                    <p><strong>Escenario:</strong> 18 estudiantes divididos en 2 grupos de 9. Cada estudiante recibe 2 caramelos aleatorios de tipos A, B, C.</p>
                    
                    <div class="formula-container">
                        <h4>Reglas de Intercambio</h4>
                        <ol>
                            <li>Si un grupo tiene al menos un conjunto {A,B,C}, intercambia por 1 chupet√≠n</li>
                            <li>Con 2 conjuntos completos: 2 chupetines + 1 caramelo extra</li>
                            <li>Todos iguales con chupetines: -1 chupet√≠n, +3 caramelos</li>
                            <li>Gana el primer grupo en alcanzar 9 chupetines</li>
                        </ol>
                    </div>
                </div>

                <!-- AN√ÅLISIS PROBABIL√çSTICO -->
                <div class="section">
                    <h3>üìä An√°lisis Probabil√≠stico</h3>
                    
                    <div class="formula">
                        <strong>Distribuci√≥n inicial:</strong>
                        $$ X \sim \text{Multinomial}(n=18, p=[\tfrac{1}{3}, \tfrac{1}{3}, \tfrac{1}{3}]) $$
                    </div>
                    
                    <div class="formula">
                        <strong>Probabilidad de conjunto completo:</strong>
                        $$ P(\text{A,B,C}) = 1 - 3(\tfrac{2}{3})^{18} + 3(\tfrac{1}{3})^{18} $$
                        $$ \approx 0.9998 \ (\text{casi seguro}) $$
                    </div>
                    
                    <div class="formula">
                        <strong>N√∫mero esperado de conjuntos:</strong>
                        $$ E[\text{conjuntos}] = \frac{18}{3} = 6 $$
                    </div>
                </div>

                <!-- SIMULACI√ìN INTERACTIVA -->
                <div class="simulation-container">
                    <h3>üé≤ Simulaci√≥n Interactiva</h3>
                    
                    <div class="input-group">
                        <input type="number" id="numEstudiantes" class="input-field" 
                               placeholder="Estudiantes por grupo" value="9" min="3" max="20">
                        <input type="number" id="caramelosxEst" class="input-field" 
                               placeholder="Caramelos por estudiante" value="2" min="1" max="5">
                        <input type="number" id="metaChupetines" class="input-field" 
                               placeholder="Chupetines para ganar" value="9" min="1" max="20">
                        <input type="number" id="rondasMax" class="input-field" 
                               placeholder="Rondas m√°ximas" value="20" min="5" max="100">
                        <input type="number" id="numSimulaciones" class="input-field" 
                               placeholder="N¬∫ simulaciones" value="100" min="1" max="1000">
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="ejecutarSimulacionCaramelos()">
                            üöÄ Ejecutar Simulaci√≥n
                        </button>
                        <button class="btn btn-secondary" onclick="analisisProbabilistico()">
                            üìà An√°lisis Probabil√≠stico
                        </button>
                        <button class="btn btn-secondary" onclick="simulacionMultiple()">
                            üîÅ Simulaci√≥n M√∫ltiple
                        </button>
                    </div>
                    
                    <div class="results" id="resultadosCaramelos">
                        <p style="color: var(--gris-medio);">Los resultados aparecer√°n aqu√≠...</p>
                    </div>
                    
                    <div class="canvas-container">
                        <canvas id="graficoCaramelos" width="800" height="400"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 10: ALGORITMO DEMONS -->
        <div id="act10" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 10 ‚Äî Algoritmo Demons para Registro de Im√°genes M√©dicas</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('tarea de resumenes.pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-primary" onclick="simularRegistroDemons()">üñºÔ∏è Simular Registro</button>
                </div>

                <!-- RESUMEN DEL ALGORITMO -->
                <div class="section">
                    <h3>üëø Algoritmo Demons (Thirion, 1998)</h3>
                    <p><strong>Problema:</strong> Registro no r√≠gido de im√°genes m√©dicas para alinear im√°genes de diferentes momentos o modalidades.</p>
                    
                    <div class="formula-container">
                        <h4>Formulaci√≥n Cl√°sica</h4>
                        <div class="formula">
                            $$ \mathbf{u} = \frac{(F - R)\nabla R}{\|\nabla R\|^2 + (F - R)^2} $$
                            <small>Donde $R$ es la imagen de referencia, $F$ la imagen m√≥vil, $\mathbf{u}$ el campo de desplazamiento.</small>
                        </div>
                    </div>
                    
                    <div class="formula-container">
                        <h4>Versi√≥n Sim√©trica Mejorada</h4>
                        <div class="formula">
                            $$ \mathbf{u} = \frac{(F - R)(\nabla R + \nabla F)}{\|\nabla R + \nabla F\|^2 + \alpha^2(F - R)^2} $$
                        </div>
                    </div>
                </div>

                <!-- MEJORAS CON CAMPO DE IMAGEN -->
                <div class="section">
                    <h3>üñºÔ∏è Mejoras con Campo de Imagen</h3>
                    
                    <div class="formula">
                        <strong>Campo de imagen multiescala:</strong>
                        $$ \mathbf{G}_{\sigma}(x,y) = \nabla(I * G_{\sigma})(x,y) $$
                    </div>
                    
                    <div class="formula">
                        <strong>Funci√≥n de peso adaptativa:</strong>
                        $$ w(x,y) = \exp\left(-\frac{\|\nabla I(x,y)\|^2}{2\sigma_g^2}\right) $$
                    </div>
                    
                    <div class="formula">
                        <strong>Regularizaci√≥n anisotr√≥pica:</strong>
                        $$ \frac{\partial \mathbf{u}}{\partial t} = \text{div}(c(\|\nabla \mathbf{u}\|)\nabla \mathbf{u}) $$
                    </div>
                </div>

                <!-- APLICACI√ìN PR√ÅCTICA -->
                <div class="section">
                    <h3>üè• Aplicaci√≥n en Im√°genes M√©dicas</h3>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Aplicaci√≥n</th>
                                    <th>Imagen Referencia</th>
                                    <th>Imagen M√≥vil</th>
                                    <th>Beneficio</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Seguimiento de tumores</td>
                                    <td>CT inicial</td>
                                    <td>CT despu√©s de tratamiento</td>
                                    <td>Monitoreo preciso de cambios</td>
                                </tr>
                                <tr>
                                    <td>Fusi√≥n multimodal</td>
                                    <td>MRI (alta resoluci√≥n)</td>
                                    <td>PET (funcional)</td>
                                    <td>Informaci√≥n anat√≥mica + funcional</td>
                                </tr>
                                <tr>
                                    <td>Neuroimagen</td>
                                    <td>Atlas cerebral</td>
                                    <td>Paciente espec√≠fico</td>
                                    <td>Localizaci√≥n de estructuras</td>
                                </tr>
                                <tr>
                                    <td>Cardiolog√≠a</td>
                                    <td>S√≠stole</td>
                                    <td>Di√°stole</td>
                                    <td>An√°lisis de movimiento card√≠aco</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 11: DIFERENCIACI√ìN NUM√âRICA -->
        <div id="act11" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 11 ‚Äî Diferenciaci√≥n Num√©rica: Diferencias Finitas</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('Actividad11 (1).pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-primary" onclick="calcularDerivadaNumerica()">üìê Simular Diferenciaci√≥n</button>
                </div>

                <!-- TEOR√çA COMPLETA -->
                <div class="section">
                    <h3>üìò Teor√≠a de Diferenciaci√≥n Num√©rica</h3>
                    
                    <div class="formula-container">
                        <h4>¬øQu√© es la Derivada?</h4>
                        <div class="formula">
                            $$ f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h} $$
                            <p>La derivada mide c√≥mo cambia una funci√≥n en un punto. Ejemplos:</p>
                            <ul>
                                <li>Si $f(t)$ es distancia: $f'(t)$ es velocidad</li>
                                <li>Si $f(t)$ es velocidad: $f'(t)$ es aceleraci√≥n</li>
                                <li>Si $f(x)$ es temperatura: $f'(x)$ es gradiente t√©rmico</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="formula-container">
                        <h4>Interpretaci√≥n de $h$</h4>
                        <p>$h$ es un paso peque√±o que usamos para aproximar el l√≠mite. <strong>Analog√≠a:</strong> Calcular velocidad de un auto:</p>
                        <ul>
                            <li>Posici√≥n inicial: km 10 (esto es $x$)</li>
                            <li>Tiempo despu√©s: 2 minutos (esto es $h$)</li>
                            <li>Nueva posici√≥n: km 13 (esto es $x+h$)</li>
                            <li>Velocidad ‚âà $\frac{13-10}{2} = 1.5$ km/min</li>
                        </ul>
                    </div>
                </div>

                <!-- F√ìRMULAS DE DIFERENCIAS FINITAS -->
                <div class="section">
                    <h3>üìê F√≥rmulas de Diferencias Finitas</h3>
                    
                    <div class="formula">
                        <strong>1. Diferencia Hacia Adelante (Forward):</strong>
                        $$ f'(x) \approx \frac{f(x+h) - f(x)}{h} $$
                        <small>Error: $O(h)$</small>
                    </div>
                    
                    <div class="formula">
                        <strong>2. Diferencia Hacia Atr√°s (Backward):</strong>
                        $$ f'(x) \approx \frac{f(x) - f(x-h)}{h} $$
                        <small>Error: $O(h)$</small>
                    </div>
                    
                    <div class="formula">
                        <strong>3. Diferencia Centrada (Central):</strong>
                        $$ f'(x) \approx \frac{f(x+h) - f(x-h)}{2h} $$
                        <small>Error: $O(h^2)$ - ¬°M√°s preciso!</small>
                    </div>
                    
                    <div class="formula">
                        <strong>4. Segunda derivada:</strong>
                        $$ f''(x) \approx \frac{f(x+h) - 2f(x) + f(x-h)}{h^2} $$
                    </div>
                </div>

                <!-- EJEMPLO DETALLADO -->
                <div class="section">
                    <h3>üîç Ejemplo: $f(x) = x^2$ en $x=2$</h3>
                    
                    <div class="formula-container">
                        <h4>Con $h = 0.5$:</h4>
                        <div class="formula">
                            $$ f(2) = 4, \quad f(2.5) = 6.25 $$
                            $$ f'(2) \approx \frac{6.25 - 4}{0.5} = \frac{2.25}{0.5} = 4.5 $$
                            <small>Valor exacto: $f'(2) = 4$, Error: $0.5$</small>
                        </div>
                    </div>
                    
                    <div class="formula-container">
                        <h4>Con $h = 0.1$ (mejor):</h4>
                        <div class="formula">
                            $$ f(2.1) = 4.41 $$
                            $$ f'(2) \approx \frac{4.41 - 4}{0.1} = \frac{0.41}{0.1} = 4.1 $$
                            <small>Error: $0.1$ (¬°menor!)</small>
                        </div>
                    </div>
                </div>

                <!-- SIMULACI√ìN INTERACTIVA -->
                <div class="simulation-container">
                    <h3>üéÆ Simulador de Diferenciaci√≥n Num√©rica</h3>
                    
                    <div class="input-group">
                        <input type="text" id="funcDif" class="input-field" 
                               placeholder="Funci√≥n f(x). Ej: x^2" value="x^2">
                        <input type="number" id="puntoDif" class="input-field" 
                               placeholder="Punto x" value="2" step="0.1">
                        <input type="number" id="hDif" class="input-field" 
                               placeholder="Tama√±o h" value="0.5" step="0.01">
                        <select id="tipoDif" class="input-field">
                            <option value="forward">Diferencia Adelante</option>
                            <option value="backward">Diferencia Atr√°s</option>
                            <option value="central">Diferencia Centrada</option>
                            <option value="second">Segunda Derivada</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary" onclick="calcularDerivadaNumerica()">
                        üßÆ Calcular Derivada Num√©rica
                    </button>
                    
                    <div class="results" id="resultadosDiferenciacion">
                        <p style="color: var(--gris-medio);">Los resultados aparecer√°n aqu√≠...</p>
                    </div>
                    
                    <div class="canvas-container">
                        <canvas id="graficoDiferenciacion" width="800" height="400"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 12: INTERPOLACI√ìN NUM√âRICA -->
        <div id="act12" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 12 ‚Äî Interpolaci√≥n Num√©rica</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('actividad_12 (1).pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-primary" onclick="simularInterpolacion()">üìà Simular Interpolaci√≥n</button>
                </div>

                <!-- INTRODUCCI√ìN -->
                <div class="section">
                    <h3>üìò Introducci√≥n a la Interpolaci√≥n</h3>
                    <p>La interpolaci√≥n num√©rica estima valores desconocidos de una funci√≥n a partir de puntos conocidos. Construye una funci√≥n $P(x)$ que pasa exactamente por los puntos dados.</p>
                    
                    <div class="formula">
                        $$ P(x_i) = y_i, \quad i = 0,1,\ldots,n $$
                    </div>
                </div>

                <!-- M√âTODOS DE INTERPOLACI√ìN -->
                <div class="section">
                    <h3>üìä M√©todos de Interpolaci√≥n</h3>
                    
                    <div class="formula">
                        <strong>1. Interpolaci√≥n Lineal:</strong>
                        $$ P(x) = y_0 + \frac{y_1 - y_0}{x_1 - x_0}(x - x_0) $$
                        <small>Para dos puntos $(x_0,y_0)$ y $(x_1,y_1)$</small>
                    </div>
                    
                    <div class="formula">
                        <strong>2. Interpolaci√≥n de Lagrange:</strong>
                        $$ P(x) = \sum_{i=0}^{n} y_i L_i(x) $$
                        $$ L_i(x) = \prod_{\substack{j=0 \\ j \neq i}}^{n} \frac{x - x_j}{x_i - x_j} $$
                    </div>
                    
                    <div class="formula">
                        <strong>3. Diferencias Divididas de Newton:</strong>
                        $$ P(x) = f[x_0] + f[x_0,x_1](x-x_0) + f[x_0,x_1,x_2](x-x_0)(x-x_1) + \cdots $$
                    </div>
                    
                    <div class="formula">
                        <strong>4. Splines C√∫bicos:</strong>
                        <p>Divide el intervalo en secciones, cada una con un polinomio c√∫bico. Garantiza continuidad en funci√≥n, primera y segunda derivada.</p>
                    </div>
                </div>

                <!-- COMPARATIVA DE M√âTODOS -->
                <div class="section">
                    <h3>‚öñÔ∏è Comparativa de M√©todos</h3>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>M√©todo</th>
                                    <th>Ventajas</th>
                                    <th>Desventajas</th>
                                    <th>Uso Recomendado</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Lineal</td>
                                    <td>Simple, r√°pido</td>
                                    <td>Poca precisi√≥n, no suave</td>
                                    <td>Datos simples, velocidad cr√≠tica</td>
                                </tr>
                                <tr>
                                    <td>Lagrange</td>
                                    <td>Exacto en puntos dados</td>
                                    <td>Inestable con muchos puntos</td>
                                    <td>Pocos puntos, demostraci√≥n te√≥rica</td>
                                </tr>
                                <tr>
                                    <td>Newton</td>
                                    <td>F√°cil agregar puntos</td>
                                    <td>C√°lculo de diferencias</td>
                                    <td>Puntos no equiespaciados</td>
                                </tr>
                                <tr>
                                    <td>Splines C√∫bicos</td>
                                    <td>Suavidad, estabilidad</td>
                                    <td>M√°s complejo computacional</td>
                                    <td>Gr√°ficos, dise√±o, ingenier√≠a</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- EJEMPLO: INTERPOLACI√ìN LINEAL -->
                <div class="section">
                    <h3>üîç Ejemplo: Interpolaci√≥n Lineal para Predicci√≥n</h3>
                    
                    <div class="formula">
                        <strong>Problema:</strong> Dados $P_{2023} = 5456.5$ y $P_{2024} = 6587.0$, estimar $P_{2025}$
                        $$ P_{2025} = P_{2024} + \frac{P_{2024} - P_{2023}}{2024 - 2023}(2025 - 2024) $$
                        $$ P_{2025} = 6587.0 + \frac{6587.0 - 5456.5}{1}(1) $$
                        $$ P_{2025} = 6587.0 + 1130.5 = 7717.5 $$
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 13: APACHE JMETER -->
        <div id="act13" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 13 ‚Äî Apache JMeter: Pruebas de Rendimiento Web</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('Analisis_en_Jmeter.pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-primary" onclick="simularPruebasJMeter()">‚ö° Simular Pruebas</button>
                </div>

                <!-- INTRODUCCI√ìN A JMETER -->
                <div class="section">
                    <h3>üìä Apache JMeter en la Pr√°ctica</h3>
                    <p><strong>Objetivo:</strong> Comparar rendimiento de ESPN vs DSports bajo carga de 1000 usuarios simult√°neos.</p>
                    
                    <div class="formula-container">
                        <h4>Configuraci√≥n de Pruebas</h4>
                        <ul>
                            <li><strong>Herramienta:</strong> Apache JMeter 5.6</li>
                            <li><strong>Usuarios:</strong> 1000 concurrentes</li>
                            <li><strong>Ramp-up:</strong> 60 segundos</li>
                            <li><strong>Duraci√≥n:</strong> 300 segundos</li>
                            <li><strong>M√©tricas:</strong> Tiempo de respuesta, throughput, errores</li>
                        </ul>
                    </div>
                </div>

                <!-- RESULTADOS COMPARATIVOS -->
                <div class="section">
                    <h3>üìà Resultados: ESPN vs DSports</h3>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>M√©trica</th>
                                    <th>ESPN</th>
                                    <th>DSports</th>
                                    <th>Diferencia</th>
                                    <th>Ganador</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Tiempo Respuesta Promedio</td>
                                    <td>245 ms</td>
                                    <td>312 ms</td>
                                    <td>-67 ms</td>
                                    <td>‚úÖ ESPN</td>
                                </tr>
                                <tr>
                                    <td>Percentil 95</td>
                                    <td>480 ms</td>
                                    <td>620 ms</td>
                                    <td>-140 ms</td>
                                    <td>‚úÖ ESPN</td>
                                </tr>
                                <tr>
                                    <td>Throughput (req/s)</td>
                                    <td>1850</td>
                                    <td>1520</td>
                                    <td>+330</td>
                                    <td>‚úÖ ESPN</td>
                                </tr>
                                <tr>
                                    <td>Error Rate</td>
                                    <td>0.12%</td>
                                    <td>0.45%</td>
                                    <td>-0.33%</td>
                                    <td>‚úÖ ESPN</td>
                                </tr>
                                <tr>
                                    <td>CPU Usage</td>
                                    <td>68%</td>
                                    <td>82%</td>
                                    <td>-14%</td>
                                    <td>‚úÖ ESPN</td>
                                </tr>
                                <tr>
                                    <td>Memory Usage</td>
                                    <td>1.8 GB</td>
                                    <td>2.3 GB</td>
                                    <td>-0.5 GB</td>
                                    <td>‚úÖ ESPN</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- AN√ÅLISIS DE PERCENTILES -->
                <div class="section">
                    <h3>üìä An√°lisis de Percentiles con Interpolaci√≥n Lineal</h3>
                    
                    <div class="formula">
                        <strong>C√°lculo de percentiles:</strong>
                        $$ P_p = x_k + \frac{p(N+1) - k}{x_{k+1} - x_k} $$
                        <p>Donde $x_k$ y $x_{k+1}$ son los valores ordenados que encierran el percentil $p$.</p>
                    </div>
                    
                    <div class="formula">
                        <strong>Ejemplo para percentil 95:</strong>
                        <p>Si el percentil 95 cae entre las posiciones $k=950$ y $k=951$ de 1000 muestras:</p>
                        $$ P_{95} = t_{950} + \frac{0.95(1001) - 950}{t_{951} - t_{950}} $$
                    </div>
                </div>

                <!-- CONCLUSIONES -->
                <div class="section">
                    <h3>üéØ Conclusiones del Estudio</h3>
                    
                    <div class="formula-container">
                        <h4>Hallazgos Principales</h4>
                        <ol>
                            <li>ESPN muestra mejor optimizaci√≥n de recursos (CPU 14% menor)</li>
                            <li>El tiempo de respuesta de ESPN es 21.5% m√°s r√°pido</li>
                            <li>DSports tiene mayor variabilidad (percentil 95 m√°s alto)</li>
                            <li>ESPN maneja mejor picos de carga concurrente</li>
                            <li>La arquitectura de ESPN es m√°s eficiente en memoria</li>
                        </ol>
                    </div>
                    
                    <div class="formula-container">
                        <h4>Recomendaciones para DSports</h4>
                        <ul>
                            <li>Implementar cach√© m√°s agresivo</li>
                            <li>Optimizar consultas a base de datos</li>
                            <li>Reducir tama√±o de recursos est√°ticos</li>
                            <li>Implementar CDN global</li>
                            <li>Mejorar balanceo de carga</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 14: POSTER CIENT√çFICO -->
        <div id="act14" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 14 ‚Äî Poster Cient√≠fico: Producci√≥n de Papa en Per√∫</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('poster (1).pdf', '_blank')">üìò Ver Poster PDF</button>
                </div>

                <!-- RESUMEN DEL POSTER -->
                <div class="section">
                    <h3>üìä Estudio: Producci√≥n de Papa 1993-2024 y Proyecci√≥n 2025</h3>
                    
                    <div class="formula-container">
                        <h4>Introducci√≥n</h4>
                        <p>La papa es fundamental para la seguridad alimentaria y econom√≠a rural del Per√∫. Este estudio analiza la evoluci√≥n hist√≥rica (1993-2024) y proyecta 2025 usando interpolaci√≥n lineal.</p>
                        
                        <div class="formula">
                            <strong>F√≥rmula de Interpolaci√≥n Lineal:</strong>
                            $$ y = y_0 + \frac{y_1 - y_0}{x_1 - x_0} (x - x_0) $$
                        </div>
                    </div>
                </div>

                <!-- M√âTODOS Y DATOS -->
                <div class="section">
                    <h3>üî¨ M√©todos Utilizados</h3>
                    
                    <div class="formula">
                        <strong>Aplicaci√≥n a la Proyecci√≥n:</strong>
                        $$ P_{2025} = P_{2024} + \frac{P_{2024} - P_{2023}}{2024 - 2023}(1) $$
                        $$ P_{2025} = 6587.0 + \frac{6587.0 - 5456.5}{1}(1) $$
                        $$ P_{2025} = 6587.0 + 1130.5 = \mathbf{7717.5} $$
                        <small>Producci√≥n estimada para 2025: 7.7 millones de toneladas</small>
                    </div>
                    
                    <div class="formula-container">
                        <h4>Fuentes de Datos</h4>
                        <ul>
                            <li><strong>Fuente principal:</strong> MIDAGRI (1993-2024)</li>
                            <li><strong>An√°lisis:</strong> R y Python</li>
                            <li><strong>M√©todo:</strong> Interpolaci√≥n lineal usando diferencia 2024-2023</li>
                        </ul>
                    </div>
                </div>

                <!-- C√ìDIGO R -->
                <div class="section">
                    <h3>üíª C√≥digo en R para el An√°lisis</h3>
                    <div class="code-container">
                        <div class="code-header">
                            <span>produccion_papa.R</span>
                            <button class="btn btn-secondary" onclick="copiarCodigo('codigoPapaR')" style="padding: 0.3rem 0.8rem; font-size: 0.8rem;">Copiar</button>
                        </div>
                        <pre class="code" id="codigoPapaR"># An√°lisis de Producci√≥n de Papa en Per√∫ (1993-2024)
# Interpolaci√≥n Lineal para proyecci√≥n 2025

produccion <- c(
  1492.7, 1767.2, 2368.4, 2308.9, 2398.1, 2589.3,
  3066.2, 3273.8, 2680.1, 3300.3, 3151.2, 3008.2,
  3289.7, 3248.4, 3383.0, 3597.1, 3765.3, 3805.5,
  4072.5, 4474.7, 4569.6, 4705.0, 4715.9, 4514.2,
  4802.8, 5133.9, 5389.2, 5515.4, 5702.3, 6040.8,
  5456.5, 6587.0
)

a√±os <- 1993:2024

# Verificar datos
length(a√±os)          # 32 a√±os
length(produccion)    # 32 valores

# Gr√°fico principal
plot(a√±os, produccion,
     type = "o", pch = 16, lwd = 2,
     col = "blue",
     xlab = "A√±o",
     ylab = "Producci√≥n Agropecuaria de Papa (miles de toneladas)",
     main = "Producci√≥n de Papa (1993-2024) + Interpolaci√≥n 2025",
     ylim = c(1000, 8000))

# Interpolaci√≥n lineal para 2025
x0 <- 2023
x1 <- 2024
y0 <- 5456.5
y1 <- 6587.0

prod_2025 <- y0 + (y1 - y0) / (x1 - x0) * (2025 - x0)
prod_2025  # 7717.5

# Agregar punto proyectado
points(2025, prod_2025,
       col = "red", pch = 19, cex = 1.5)

# L√≠nea de interpolaci√≥n
lines(c(2024, 2025), c(y1, prod_2025),
      col = "red", lty = 2, lwd = 2)

# Texto con el valor
text(2025, prod_2025,
     labels = paste("2025 (estimado):", round(prod_2025, 1)),
     pos = 4, col = "red")

# Regresi√≥n lineal para comparaci√≥n
modelo <- lm(produccion ~ a√±os)
abline(modelo, col = "green", lty = 3, lwd = 1.5)

# Leyenda
legend("topleft",
       legend = c("Datos reales", "Interpolaci√≥n 2025", "Tendencia lineal"),
       col = c("blue", "red", "green"),
       lty = c(1, 2, 3),
       lwd = c(2, 2, 1.5),
       pch = c(16, 19, NA),
       bg = "white")

# Estad√≠sticas resumen
cat("RESUMEN ESTAD√çSTICO:\n")
cat("====================\n")
cat("Per√≠odo analizado:", min(a√±os), "-", max(a√±os), "\n")
cat("Producci√≥n promedio:", mean(produccion), "miles de ton\n")
cat("Producci√≥n m√°xima:", max(produccion), "en", a√±os[which.max(produccion)], "\n")
cat("Producci√≥n m√≠nima:", min(produccion), "en", a√±os[which.min(produccion)], "\n")
cat("Tasa crecimiento anual promedio:", 
    round((produccion[32]/produccion[1])^(1/31)-1, 4)*100, "%\n")
cat("\nPROYECCI√ìN 2025:\n")
cat("================\n")
cat("M√©todo: Interpolaci√≥n lineal\n")
cat("Punto A (2023):", y0, "\n")
cat("Punto B (2024):", y1, "\n")
cat("Proyecci√≥n 2025:", round(prod_2025, 1), "\n")
cat("Incremento estimado:", round(prod_2025 - y1, 1), 
    "(", round((prod_2025/y1 - 1)*100, 1), "%)\n")</pre>
                    </div>
                </div>

                <!-- RESULTADOS PRINCIPALES -->
                <div class="section">
                    <h3>üìà Resultados Clave</h3>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>A√±o</th>
                                    <th>Producci√≥n Real (miles t)</th>
                                    <th>Tendencia Lineal</th>
                                    <th>Diferencia</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1993</td>
                                    <td>1492.7</td>
                                    <td>1756.3</td>
                                    <td>-263.6</td>
                                </tr>
                                <tr>
                                    <td>2000</td>
                                    <td>3273.8</td>
                                    <td>2683.1</td>
                                    <td>+590.7</td>
                                </tr>
                                <tr>
                                    <td>2010</td>
                                    <td>3805.5</td>
                                    <td>4007.1</td>
                                    <td>-201.6</td>
                                </tr>
                                <tr>
                                    <td>2023</td>
                                    <td>5456.5</td>
                                    <td>5728.4</td>
                                    <td>-271.9</td>
                                </tr>
                                <tr>
                                    <td>2024</td>
                                    <td>6587.0</td>
                                    <td>5860.8</td>
                                    <td><strong>+726.2</strong></td>
                                </tr>
                                <tr style="background-color: rgba(255,0,0,0.1);">
                                    <td><strong>2025 (proy.)</strong></td>
                                    <td><strong>7717.5</strong></td>
                                    <td>5993.2</td>
                                    <td><strong>+1724.3</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- CONCLUSIONES -->
                <div class="section">
                    <h3>üéØ Conclusiones y Limitaciones</h3>
                    
                    <div class="formula-container">
                        <h4>Hallazgos Principales</h4>
                        <ol>
                            <li>Producci√≥n mantiene tendencia creciente desde 1993</li>
                            <li>Proyecci√≥n 2025: 7717.5 mil ton (17% aumento vs 2024)</li>
                            <li>Interpolaci√≥n lineal es √∫til para estimaciones inmediatas</li>
                        </ol>
                    </div>
                    
                    <div class="formula-container">
                        <h4>Limitaciones</h4>
                        <ul>
                            <li>No incluye variables clim√°ticas, pol√≠ticas o econ√≥micas</li>
                            <li>Para predicciones robustas: usar ARIMA o Machine Learning</li>
                            <li>Modelo simple para referencia inicial</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 15: EIGENVALORES Y EIGENVECTORES -->
        <div id="act15" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 15 ‚Äî Eigenvalores y Eigenvectores en Optimizaci√≥n</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('Tarea_1_de_Prog__Numerica.pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-primary" onclick="calcularEigenvalores()">üî¢ Calcular Eigenvalores</button>
                </div>

                <!-- TEOR√çA FUNDAMENTAL -->
                <div class="section">
                    <h3>üìò ¬øQu√© son Eigenvalores y Eigenvectores?</h3>
                    <p>Para una matriz $A$ que transforma vectores, hay vectores especiales $v$ que solo cambian de tama√±o, no de direcci√≥n:</p>
                    
                    <div class="formula">
                        $$ A\mathbf{v} = \lambda \mathbf{v} $$
                        <small>Donde $\lambda$ es el eigenvalor (cu√°nto se estira/encoge) y $\mathbf{v}$ es el eigenvector (direcci√≥n invariante).</small>
                    </div>
                    
                    <div class="formula-container">
                        <h4>Interpretaci√≥n Visual</h4>
                        <ul>
                            <li>Si $\lambda = 2$: el vector se duplica</li>
                            <li>Si $\lambda = -1$: el vector se invierte</li>
                            <li>Si $\lambda = 0.5$: el vector se reduce a la mitad</li>
                        </ul>
                    </div>
                </div>

                <!-- C√ÅLCULO DE EIGENVALORES -->
                <div class="section">
                    <h3>üßÆ C√°lculo de Eigenvalores</h3>
                    
                    <div class="formula">
                        <strong>Paso 1:</strong> Formar $(A - \lambda I)$
                        $$ A - \lambda I = \begin{bmatrix} 
                        a_{11}-\lambda & a_{12} & \cdots \\
                        a_{21} & a_{22}-\lambda & \cdots \\
                        \vdots & \vdots & \ddots
                        \end{bmatrix} $$
                    </div>
                    
                    <div class="formula">
                        <strong>Paso 2:</strong> Calcular determinante
                        $$ \det(A - \lambda I) = 0 $$
                    </div>
                    
                    <div class="formula">
                        <strong>Paso 3:</strong> Resolver para $\lambda$
                        $$ \text{Ecuaci√≥n caracter√≠stica} $$
                    </div>
                    
                    <div class="formula">
                        <strong>Paso 4:</strong> Para cada $\lambda$, resolver
                        $$ (A - \lambda I)\mathbf{v} = \mathbf{0} $$
                    </div>
                </div>

                <!-- EJEMPLO DETALLADO -->
                <div class="section">
                    <h3>üîç Ejemplo 1: Matriz Diagonal</h3>
                    
                    <div class="formula">
                        $$ A = \begin{bmatrix} 2 & 0 \\ 0 & 5 \end{bmatrix} $$
                        <p>En matrices diagonales, ¬°los eigenvalores est√°n en la diagonal!</p>
                        $$ \lambda_1 = 2, \quad \lambda_2 = 5 $$
                        $$ \mathbf{v}_1 = \begin{bmatrix} 1 \\ 0 \end{bmatrix}, \quad 
                           \mathbf{v}_2 = \begin{bmatrix} 0 \\ 1 \end{bmatrix} $$
                    </div>
                </div>

                <!-- EJEMPLO 2 -->
                <div class="section">
                    <h3>üîç Ejemplo 2: Matriz 2√ó2 General</h3>
                    
                    <div class="formula">
                        $$ A = \begin{bmatrix} 3 & 1 \\ 1 & 3 \end{bmatrix} $$
                        
                        <strong>Paso 1:</strong>
                        $$ A - \lambda I = \begin{bmatrix} 3-\lambda & 1 \\ 1 & 3-\lambda \end{bmatrix} $$
                        
                        <strong>Paso 2:</strong>
                        $$ \det = (3-\lambda)(3-\lambda) - 1 = \lambda^2 - 6\lambda + 8 = 0 $$
                        
                        <strong>Paso 3:</strong>
                        $$ (\lambda-4)(\lambda-2) = 0 \Rightarrow \lambda_1 = 4, \lambda_2 = 2 $$
                        
                        <strong>Paso 4a ($\lambda=4$):</strong>
                        $$ \begin{bmatrix} -1 & 1 \\ 1 & -1 \end{bmatrix} \mathbf{v}_1 = \mathbf{0} $$
                        $$ -v_1 + v_2 = 0 \Rightarrow \mathbf{v}_1 = \begin{bmatrix} 1 \\ 1 \end{bmatrix} $$
                        
                        <strong>Paso 4b ($\lambda=2$):</strong>
                        $$ \begin{bmatrix} 1 & 1 \\ 1 & 1 \end{bmatrix} \mathbf{v}_2 = \mathbf{0} $$
                        $$ v_1 + v_2 = 0 \Rightarrow \mathbf{v}_2 = \begin{bmatrix} 1 \\ -1 \end{bmatrix} $$
                    </div>
                </div>

                <!-- IMPORTANCIA EN OPTIMIZACI√ìN -->
                <div class="section">
                    <h3>üìà Importancia en Optimizaci√≥n</h3>
                    
                    <div class="formula-container">
                        <h4>Matriz Hessiana y Puntos Cr√≠ticos</h4>
                        <p>Para optimizar $f(x_1,\ldots,x_n)$:</p>
                        <ol>
                            <li>Encontrar puntos cr√≠ticos: $\nabla f = \mathbf{0}$</li>
                            <li>Clasificar usando Hessiana $H$</li>
                        </ol>
                        
                        <div class="formula">
                            $$ H = \begin{bmatrix} 
                            \frac{\partial^2 f}{\partial x_1^2} & \frac{\partial^2 f}{\partial x_1 \partial x_2} \\
                            \frac{\partial^2 f}{\partial x_2 \partial x_1} & \frac{\partial^2 f}{\partial x_2^2}
                            \end{bmatrix} $$
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Eigenvalores de $H$</th>
                                    <th>Tipo de Punto</th>
                                    <th>Interpretaci√≥n</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Todos $> 0$</td>
                                    <td><strong>M√≠nimo local</strong></td>
                                    <td>Funci√≥n convexa alrededor</td>
                                </tr>
                                <tr>
                                    <td>Todos $< 0$</td>
                                    <td><strong>M√°ximo local</strong></td>
                                    <td>Funci√≥n c√≥ncava alrededor</td>
                                </tr>
                                <tr>
                                    <td>Mezcla de signos</td>
                                    <td><strong>Punto silla</strong></td>
                                    <td>Ni m√°ximo ni m√≠nimo</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- EJEMPLO DE OPTIMIZACI√ìN -->
                <div class="section">
                    <h3>üîç Ejemplo 3: Clasificar Punto Cr√≠tico</h3>
                    
                    <div class="formula">
                        <strong>Funci√≥n:</strong> $f(x_1,x_2) = x_1^2 + 3x_2^2 + 2x_1x_2$
                        
                        <p>El punto $(0,0)$ es cr√≠tico ($\nabla f = \mathbf{0}$). ¬øM√°ximo, m√≠nimo o silla?</p>
                        
                        <strong>Paso 1:</strong> Calcular Hessiana
                        $$ \frac{\partial^2 f}{\partial x_1^2} = 2, \quad 
                           \frac{\partial^2 f}{\partial x_2^2} = 6, \quad
                           \frac{\partial^2 f}{\partial x_1 \partial x_2} = 2 $$
                        $$ H = \begin{bmatrix} 2 & 2 \\ 2 & 6 \end{bmatrix} $$
                        
                        <strong>Paso 2:</strong> Eigenvalores de $H$
                        $$ \det(H-\lambda I) = (2-\lambda)(6-\lambda) - 4 = \lambda^2 - 8\lambda + 8 = 0 $$
                        $$ \lambda = \frac{8 \pm \sqrt{64-32}}{2} = \frac{8 \pm \sqrt{32}}{2} \approx 6.83, 1.17 $$
                        
                        <strong>Paso 3:</strong> Clasificar
                        <p>Ambos eigenvalores positivos ‚áí <strong>M√çNIMO LOCAL</strong></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 16: CADENAS DE MARKOV -->
        <div id="act16" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 16 ‚Äî Cadenas de Markov y Procesos Estoc√°sticos</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('Tarea_1_de_Prog__Numerica.pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-secondary" onclick="window.open('tarea_2_de_Prog__Numerica.pdf', '_blank')">üìò Ver PDF</button>
                     <button class="btn btn-secondary" onclick="window.open('tarea_3_de_Prog__Numerica.pdf', '_blank')">üìò Ver PDF</button>
                    <button class="btn btn-primary" onclick="ejecutarSimulacionMarkov()">üîÑ Simular Cadena de Markov</button>
                </div>

                <!-- INTRODUCCI√ìN -->
                <div class="section">
                    <h3>üìò Introducci√≥n a las Cadenas de Markov</h3>
                    <p>Proceso estoc√°stico con <strong>propiedad de Markov</strong>: el futuro depende solo del presente, no del pasado.</p>
                    
                    <div class="formula">
                        $$ P(X_{t+1} = x_{t+1} | X_t = x_t, X_{t-1} = x_{t-1}, \ldots) = P(X_{t+1} = x_{t+1} | X_t = x_t) $$
                    </div>
                </div>

                <!-- MATRIZ DE TRANSICI√ìN -->
                <div class="section">
                    <h3>üî¢ Matriz de Transici√≥n</h3>
                    
                    <div class="formula">
                        $$ P = \begin{bmatrix}
                        p_{11} & p_{12} & \cdots & p_{1n} \\
                        p_{21} & p_{22} & \cdots & p_{2n} \\
                        \vdots & \vdots & \ddots & \vdots \\
                        p_{n1} & p_{n2} & \cdots & p_{nn}
                        \end{bmatrix} $$
                        <small>Donde $p_{ij} = P(\text{ir a estado }j \mid \text{estar en estado }i)$</small>
                    </div>
                    
                    <div class="formula-container">
                        <h4>Propiedades</h4>
                        <ol>
                            <li>$0 \leq p_{ij} \leq 1$ para todo $i,j$</li>
                            <li>Suma por filas = 1: $\sum_{j=1}^n p_{ij} = 1$ para todo $i$</li>
                        </ol>
                    </div>
                </div>

                <!-- ESTADO ESTABLE -->
                <div class="section">
                    <h3>‚öñÔ∏è Estado Estacionario (Estable)</h3>
                    
                    <div class="formula">
                        <strong>Vector de estado estable $\pi$:</strong>
                        $$ \pi P = \pi, \quad \sum_{i=1}^n \pi_i = 1 $$
                        <p>Representa la distribuci√≥n de probabilidad a largo plazo.</p>
                    </div>
                    
                    <div class="formula">
                        <strong>C√°lculo:</strong>
                        $$ \pi(P - I) = \mathbf{0}, \quad \sum \pi_i = 1 $$
                    </div>
                </div>

                <!-- EJEMPLO: PRON√ìSTICO DEL CLIMA -->
                <div class="section">
                    <h3>üå§Ô∏è Ejemplo: Pron√≥stico del Clima</h3>
                    
                    <div class="formula">
                        <strong>Estados:</strong> Soleado (S), Nublado (N), Lluvioso (L)
                        
                        $$ P = \begin{bmatrix}
                        0.6 & 0.3 & 0.1 \\  # S ‚Üí S, N, L
                        0.4 & 0.4 & 0.2 \\  # N ‚Üí S, N, L
                        0.2 & 0.3 & 0.5     # L ‚Üí S, N, L
                        \end{bmatrix} $$
                    </div>
                    
                    <div class="formula">
                        <strong>Estado estable:</strong> Resolver $\pi P = \pi$
                        $$ \pi_S = 0.44, \quad \pi_N = 0.33, \quad \pi_L = 0.23 $$
                        <p>A largo plazo: 44% d√≠as soleados, 33% nublados, 23% lluviosos.</p>
                    </div>
                </div>

                <!-- APLICACIONES -->
                <div class="section">
                    <h3>üèóÔ∏è Aplicaciones de Cadenas de Markov</h3>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Aplicaci√≥n</th>
                                    <th>Estados</th>
                                    <th>Uso</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Pron√≥stico del tiempo</td>
                                    <td>Soleado, Nublado, Lluvia</td>
                                    <td>Predicci√≥n clim√°tica</td>
                                </tr>
                                <tr>
                                    <td>Finanzas</td>
                                    <td>Alza, Baja, Estable</td>
                                    <td>Modelar precios de acciones</td>
                                </tr>
                                <tr>
                                    <td>Salud</td>
                                    <td>Sano, Enfermo, Recuperado</td>
                                    <td>Modelar progresi√≥n de enfermedades</td>
                                </tr>
                                <tr>
                                    <td>Juegos</td>
                                    <td>Posiciones del tablero</td>
                                    <td>Probabilidades en juegos de azar</td>
                                </tr>
                                <tr>
                                    <td>Ling√º√≠stica</td>
                                    <td>Partes del discurso</td>
                                    <td>Modelar secuencias de palabras</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- SIMULACI√ìN -->
                <div class="simulation-container">
                    <h3>üéÆ Simulador de Cadena de Markov</h3>
                    
                    <div class="input-group">
                        <select id="tipoCadena" class="input-field">
                            <option value="clima">Pron√≥stico del Clima</option>
                            <option value="finanzas">Mercado Financiero</option>
                            <option value="salud">Progresi√≥n de Enfermedad</option>
                            <option value="personalizado">Personalizado</option>
                        </select>
                        <input type="number" id="pasosMarkov" class="input-field" 
                               placeholder="N√∫mero de pasos" value="100" min="10" max="1000">
                        <input type="number" id="estadoInicial" class="input-field" 
                               placeholder="Estado inicial (0,1,2)" value="0" min="0" max="2">
                        <input type="number" id="simulacionesMarkov" class="input-field" 
                               placeholder="N¬∫ simulaciones" value="1" min="1" max="100">
                    </div>
                    
                    <button class="btn btn-primary" onclick="ejecutarSimulacionMarkov()">
                        üîÑ Ejecutar Simulaci√≥n
                    </button>
                    
                    <div class="results" id="resultadosMarkov">
                        <p style="color: var(--gris-medio);">Los resultados aparecer√°n aqu√≠...</p>
                    </div>
                    
                    <div class="canvas-container">
                        <canvas id="graficoMarkov" width="800" height="400"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIVIDAD 17: LIBRO COMPLETO -->
        <div id="act17" class="activity-content" style="display: none;">
            <div class="activity-container">
                <h2>Actividad 17 ‚Äî Libro Completo de la Unidad 2</h2>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showActivity('menu')">‚¨Ö Volver al Men√∫</button>
                    <button class="btn btn-secondary" onclick="window.open('Libro_Unidad2.pdf', '_blank')">üìò Ver Libro PDF</button>
                    <button class="btn btn-primary" onclick="mostrarResumenUnidad()">üìä Ver Resumen</button>
                </div>

                <!-- RESUMEN DE LA UNIDAD -->
                <div class="section">
                    <h3>üìö Resumen de la Unidad 2: Programaci√≥n Num√©rica</h3>
                    
                    <div class="formula-container">
                        <h4>Temas Cubiertos (1-16)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                            <div style="background: var(--degradado-azul-claro); padding: 1rem; border-radius: 6px;">
                                <h5>üìà M√©todos Num√©ricos (1-5)</h5>
                                <ul>
                                    <li>Bisecci√≥n - Teorema de Bolzano</li>
                                    <li>Secante - Orden 1.618</li>
                                    <li>Punto Fijo - Condici√≥n $|g'(x)|<1$</li>
                                    <li>Regula Falsi - Falsa posici√≥n</li>
                                    <li>Newton-Raphson - Convergencia cuadr√°tica</li>
                                </ul>
                            </div>
                            
                            <div style="background: var(--degradado-azul-claro); padding: 1rem; border-radius: 6px;">
                                <h5>üìä M√©tricas y Simulaciones (6-10)</h5>
                                <ul>
                                    <li>√çndice H - M√©trica bibliom√©trica</li>
                                    <li>Gradiente - Optimizaci√≥n</li>
                                    <li>Pseudoinverso vs GD - Comparativa</li>
                                    <li>Simulaci√≥n Caramelos - Estoc√°stica</li>
                                    <li>Algoritmo Demons - Im√°genes m√©dicas</li>
                                </ul>
                            </div>
                            
                            <div style="background: var(--degradado-azul-claro); padding: 1rem; border-radius: 6px;">
                                <h5>üî¢ M√©todos Avanzados (11-16)</h5>
                                <ul>
                                    <li>Diferenciaci√≥n Num√©rica - Diferencias finitas</li>
                                    <li>Interpolaci√≥n - Lagrange, Newton, Splines</li>
                                    <li>Apache JMeter - Pruebas de rendimiento</li>
                                    <li>Poster Cient√≠fico - Comunicaci√≥n acad√©mica</li>
                                    <li>Eigenvalores - An√°lisis espectral</li>
                                    <li>Cadenas de Markov - Procesos estoc√°sticos</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- COMPILACI√ìN DE C√ìDIGOS -->
                <div class="section">
                    <h3>üíª Compilaci√≥n de C√≥digos Fuente</h3>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Actividad</th>
                                    <th>Archivo</th>
                                    <th>Lenguaje</th>
                                    <th>Descargas</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1. Bisecci√≥n</td>
                                    <td>biseccion.py</td>
                                    <td>Python</td>
                                    <td><button class="btn" style="padding: 0.3rem 0.8rem;" onclick="descargarCodigo('biseccion')">üì• Descargar</button></td>
                                </tr>
                                <tr>
                                    <td>6. √çndice H</td>
                                    <td>h_index_calculator.py</td>
                                    <td>Python</td>
                                    <td><button class="btn" style="padding: 0.3rem 0.8rem;" onclick="descargarCodigo('h_index')">üì• Descargar</button></td>
                                </tr>
                                <tr>
                                    <td>9. Caramelos</td>
                                    <td>simulacion_caramelos.R</td>
                                    <td>R</td>
                                    <td><button class="btn" style="padding: 0.3rem 0.8rem;" onclick="descargarCodigo('caramelos')">üì• Descargar</button></td>
                                </tr>
                                <tr>
                                    <td>11. Diferenciaci√≥n</td>
                                    <td>diferenciacion_numerica.py</td>
                                    <td>Python</td>
                                    <td><button class="btn" style="padding: 0.3rem 0.8rem;" onclick="descargarCodigo('diferenciacion')">üì• Descargar</button></td>
                                </tr>
                                <tr>
                                    <td>14. Producci√≥n Papa</td>
                                    <td>produccion_papa.R</td>
                                    <td>R</td>
                                    <td><button class="btn" style="padding: 0.3rem 0.8rem;" onclick="descargarCodigo('papa')">üì• Descargar</button></td>
                                </tr>
                                <tr>
                                    <td>16. Cadenas Markov</td>
                                    <td>markov_chains.py</td>
                                    <td>Python</td>
                                    <td><button class="btn" style="padding: 0.3rem 0.8rem;" onclick="descargarCodigo('markov')">üì• Descargar</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- REFERENCIAS BIBLIOGR√ÅFICAS -->
                <div class="section">
                    <h3>üìñ Referencias Bibliogr√°ficas</h3>
                    
                    <div class="formula-container">
                        <h4>Libros de Texto</h4>
                        <ol>
                            <li>Burden, R. L., & Faires, J. D. (2010). <em>Numerical Analysis</em>. Cengage Learning.</li>
                            <li>Press, W. H., et al. (2007). <em>Numerical Recipes: The Art of Scientific Computing</em>. Cambridge University Press.</li>
                            <li>Strang, G. (2019). <em>Linear Algebra and Learning from Data</em>. Wellesley-Cambridge Press.</li>
                        </ol>
                        
                        <h4>Art√≠culos Cient√≠ficos</h4>
                        <ol>
                            <li>Thirion, J. P. (1998). <em>Image matching as a diffusion process</em>. Medical Image Analysis.</li>
                            <li>Hirsch, J. E. (2005). <em>An index to quantify an individual's scientific research output</em>. PNAS.</li>
                            <li>MIDAGRI. (2024). <em>Estad√≠sticas Agrarias del Per√∫</em>. Gobierno del Per√∫.</li>
                        </ol>
                    </div>
                </div>

                <!-- EVALUACI√ìN Y AUTOEVALUACI√ìN -->
                <div class="section">
                    <h3>üìù Evaluaci√≥n de la Unidad</h3>
                    
                    <div class="formula-container">
                        <h4>Logros Alcanzados</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div style="text-align: center; padding: 1rem; background: linear-gradient(135deg, #e6f2ff, #f0f8ff); border-radius: 8px;">
                                <div style="font-size: 2rem; color: var(--azul-primario);">16</div>
                                <div style="font-size: 0.9rem;">Actividades Completadas</div>
                            </div>
                            
                            <div style="text-align: center; padding: 1rem; background: linear-gradient(135deg, #e6f2ff, #f0f8ff); border-radius: 8px;">
                                <div style="font-size: 2rem; color: var(--azul-primario);">8+</div>
                                <div style="font-size: 0.9rem;">Lenguajes de Programaci√≥n</div>
                            </div>
                            
                            <div style="text-align: center; padding: 1rem; background: linear-gradient(135deg, #e6f2ff, #f0f8ff); border-radius: 8px;">
                                <div style="font-size: 2rem; color: var(--azul-primario);">25+</div>
                                <div style="font-size: 0.9rem;">Algoritmos Implementados</div>
                            </div>
                            
                            <div style="text-align: center; padding: 1rem; background: linear-gradient(135deg, #e6f2ff, #f0f8ff); border-radius: 8px;">
                                <div style="font-size: 2rem; color: var(--azul-primario);">100%</div>
                                <div style="font-size: 0.9rem;">Portafolio Digital</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CONCLUSI√ìN FINAL -->
                <div class="section">
                    <h3>üéì Conclusi√≥n del Portafolio</h3>
                    
                    <div class="formula-container" style="background: linear-gradient(135deg, rgba(0,102,204,0.1), rgba(0,102,204,0.05));">
                        <p style="text-align: center; font-size: 1.1rem;">
                            Este portafolio digital representa el dominio completo de los m√©todos num√©ricos 
                            aplicados a problemas reales en ciencia, ingenier√≠a y tecnolog√≠a.
                        </p>
                        <p style="text-align: center; color: var(--azul-primario); font-weight: bold;">
                            Luis Angel Quenaya Loza | C√≥digo: 241411<br>
                            Universidad Nacional del Altiplano<br>
                            Facultad de Ingenier√≠a Estad√≠stica e Inform√°tica<br>
                            2025
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>¬© 2025 - LUIS ANGEL QUENAYA LOZA - Programaci√≥n Num√©rica - Unidad 2</p>
            <p>C√≥digo: 241411 - Universidad Nacional del Altiplano</p>
        </div>
    </div>

    <!-- JavaScript Principal -->
    <script>
        // Variables globales para gr√°ficos
        let chartH = null;
        let chartGradiente = null;
        let chartComparacion = null;
        let chartCaramelos = null;
        let chartDiferenciacion = null;
        let chartMarkov = null;
        
        // Datos de docentes (del LaTeX proporcionado)
        const docentesData = [
            { nombre: "Apaza-Tarqui, Alejandro", h: 1, publicaciones: 5, link: "https://www.scopus.com/authid/detail.uri?authorId=57224362115" },
            { nombre: "Carpio Vargas, Edgar Eloy", h: 3, publicaciones: 9, link: "https://www.scopus.com/authid/detail.uri?authorId=57221112735" },
            { nombre: "Canqui-Flores, Bernab√©", h: 3, publicaciones: 8, link: "https://www.scopus.com/authid/detail.uri?authorId=57214094525" },
            { nombre: "Choquejahua-Acero, Remo", h: 1, publicaciones: 2, link: "https://www.scopus.com/authid/detail.uri?authorId=58491331500" },
            { nombre: "Coyla-Idme, Leonel", h: 1, publicaciones: 5, link: "https://www.scopus.com/authid/detail.uri?authorId=58930847700" },
            { nombre: "Gonzales, Leonid Alem√°n", h: 0, publicaciones: 4, link: "https://www.scopus.com/authid/detail.uri?authorId=58898481200" },
            { nombre: "Gonzalo Copari Romero, Fredy", h: 0, publicaciones: 2, link: "https://www.scopus.com/authid/detail.uri?authorId=59325707300" },
            { nombre: "Huata-Panca, Percy", h: 2, publicaciones: 3, link: "https://www.scopus.com/authid/detail.uri?authorId=57571711100" },
            { nombre: "Iba√±ez-Quispe, Vladimiro", h: 5, publicaciones: 21, link: "https://www.scopus.com/authid/detail.uri?authorId=57201897173" },
            { nombre: "Javier Quispe Carita, Angel", h: 1, publicaciones: 1, link: "https://www.scopus.com/authid/detail.uri?authorId=55865380000" },
            { nombre: "Laura Murillo, Ramiro", h: 1, publicaciones: 2, link: "https://www.scopus.com/authid/detail.uri?authorId=58671914800" },
            { nombre: "L√≥pez-Cueva, Milton Antonio", h: 1, publicaciones: 6, link: "https://www.scopus.com/authid/detail.uri?authorId=58671914800" },
            { nombre: "Melgarejo-Bolivar, Romel P.", h: 3, publicaciones: 6, link: "https://www.scopus.com/authid/detail.uri?authorId=58778725100" },
            { nombre: "Mendoza-Mollocondo, Charles Ignacio", h: 3, publicaciones: 8, link: "https://www.scopus.com/authid/detail.uri?authorId=57562709900" },
            { nombre: "Herrera-Urtiaga, Alain Paul", h: 0, publicaciones: 3, link: "https://www.scopus.com/authid/detail.uri?authorId=58308326900" },
            { nombre: "Tito Lipa, Jos√© P√°nfilo", h: 0, publicaciones: 3, link: "https://www.scopus.com/authid/detail.uri?authorId=58088282100" },
            { nombre: "Tumi-Figueroa, Ernesto Nayer", h: 3, publicaciones: 6, link: "https://www.scopus.com/authid/detail.uri?authorId=57003617100" }
        ];
        
        // Inicializar p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar tabla de docentes
            cargarTablaDocentes();
            
            // Inicializar MathJax
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        });
        
        // Funci√≥n para mostrar actividad
        function showActivity(activityId) {
            // Ocultar todas las actividades
            document.querySelectorAll('.activity-content').forEach(el => {
                el.style.display = 'none';
            });
            
            // Mostrar actividad seleccionada
            document.getElementById(activityId).style.display = 'block';
            
            // Actualizar pesta√±as activas
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activar pesta√±a correspondiente
            const tabIndex = activityId === 'menu' ? 0 : 
                           activityId === 'act1' ? 1 :
                           activityId === 'act2' ? 2 :
                           activityId === 'act3' ? 3 :
                           activityId === 'act4' ? 4 :
                           activityId === 'act5' ? 5 :
                           activityId === 'act6' ? 6 :
                           activityId === 'act7' ? 7 :
                           activityId === 'act8' ? 8 :
                           activityId === 'act9' ? 9 :
                           activityId === 'act10' ? 10 :
                           activityId === 'act11' ? 11 :
                           activityId === 'act12' ? 12 :
                           activityId === 'act13' ? 13 :
                           activityId === 'act14' ? 14 :
                           activityId === 'act15' ? 15 :
                           activityId === 'act16' ? 16 : 17;
            
            document.querySelectorAll('.nav-tab')[tabIndex].classList.add('active');
            
            // Actualizar MathJax
            if (window.MathJax) {
                setTimeout(() => MathJax.typesetPromise(), 100);
            }
            
            // Desplazar al inicio
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Funci√≥n para cargar tabla de docentes
        function cargarTablaDocentes() {
            const tbody = document.getElementById('docentesTable');
            if (!tbody) return;
            
            tbody.innerHTML = docentesData.map(docente => `
                <tr>
                    <td>${docente.nombre}</td>
                    <td><span class="h-index">${docente.h}</span></td>
                    <td>${docente.publicaciones}</td>
                    <td><a href="${docente.link}" target="_blank" style="color: var(--azul-primario);">Ver Scopus</a></td>
                </tr>
            `).join('');
        }
        
        // Funci√≥n para calcular √≠ndice H
        function calcularIndiceH() {
            const citasStr = document.getElementById('citasInput').value;
            const a√±os = parseFloat(document.getElementById('aniosInput').value);
            
            // Convertir a array de n√∫meros
            const citas = citasStr.split(',').map(c => parseFloat(c.trim())).filter(c => !isNaN(c));
            
            if (citas.length === 0) {
                alert('Por favor ingresa citas v√°lidas');
                return;
            }
            
            // Ordenar de mayor a menor
            citas.sort((a, b) => b - a);
            
            // Calcular √≠ndice H
            let h = 0;
            for (let i = 0; i < citas.length; i++) {
                if (citas[i] >= i + 1) {
                    h = i + 1;
                } else {
                    break;
                }
            }
            
            // Calcular otras m√©tricas
            const totalCitas = citas.reduce((sum, c) => sum + c, 0);
            const promedio = totalCitas / citas.length;
            const m = a√±os > 0 ? h / a√±os : 0;
            
            // Calcular √≠ndice g
            let sumaAcumulada = 0;
            let g = 0;
            for (let i = 0; i < citas.length; i++) {
                sumaAcumulada += citas[i];
                if (sumaAcumulada >= Math.pow(i + 1, 2)) {
                    g = i + 1;
                }
            }
            
            // Mostrar resultados
            const resultadosDiv = document.getElementById('resultadosH');
            resultadosDiv.innerHTML = `
                <div style="background: linear-gradient(135deg, #e6f2ff, #f0f8ff); padding: 1.5rem; border-radius: 8px;">
                    <h4 style="color: var(--azul-secundario); margin-bottom: 1rem;">üìä Resultados del √çndice H</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">√çndice H</h5>
                            <div style="font-size: 2rem; font-weight: bold; color: var(--azul-primario);">${h}</div>
                            <small>${h} publicaciones con al menos ${h} citas</small>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">√çndice m</h5>
                            <div style="font-size: 2rem; font-weight: bold; color: ${m >= 1 ? '#28a745' : m >= 0.5 ? '#ffc107' : '#dc3545'};">${m.toFixed(2)}</div>
                            <small>${m >= 1 ? 'Excelente' : m >= 0.5 ? 'Moderado' : 'Bajo'}</small>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Total Citas</h5>
                            <div style="font-size: 2rem; font-weight: bold; color: var(--azul-primario);">${totalCitas}</div>
                            <small>Promedio: ${promedio.toFixed(1)}</small>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">√çndice g</h5>
                            <div style="font-size: 2rem; font-weight: bold; color: var(--azul-primario);">${g}</div>
                            <small>Suma(citas) ‚â• g¬≤</small>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">üìà Distribuci√≥n de Citas</h5>
                        <div style="height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden;">
                            ${citas.map((c, i) => `
                                <div style="height: 100%; width: ${100/citas.length}%; background: ${c >= h ? 'var(--azul-primario)' : '#6c757d'}; float: left; border-right: 1px solid white;" 
                                     title="Publicaci√≥n ${i+1}: ${c} citas"></div>
                            `).join('')}
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 0.5rem; font-size: 0.8rem; color: var(--gris-medio);">
                            <span>‚â•${h} citas</span>
                            <span><${h} citas</span>
                        </div>
                    </div>
                </div>
            `;
            
            // Actualizar gr√°fico
            actualizarGraficoH(citas, h);
        }
        
        // Funci√≥n para actualizar gr√°fico del √≠ndice H
        function actualizarGraficoH(citas, h) {
            const ctx = document.getElementById('graficoH').getContext('2d');
            
            // Destruir gr√°fico anterior si existe
            if (chartH) {
                chartH.destroy();
            }
            
            // Preparar datos
            const indices = Array.from({length: citas.length}, (_, i) => i + 1);
            const citasOrdenadas = [...citas].sort((a, b) => b - a);
            
            chartH = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: indices.map(i => `P${i}`),
                    datasets: [
                        {
                            label: 'N√∫mero de citas',
                            data: citasOrdenadas,
                            backgroundColor: citasOrdenadas.map((c, i) => 
                                c >= i + 1 ? 'rgba(0, 102, 204, 0.7)' : 'rgba(108, 117, 125, 0.5)'
                            ),
                            borderColor: citasOrdenadas.map((c, i) => 
                                c >= i + 1 ? 'rgb(0, 102, 204)' : 'rgb(108, 117, 125)'
                            ),
                            borderWidth: 1
                        },
                        {
                            label: 'L√≠nea h=i',
                            data: indices,
                            type: 'line',
                            fill: false,
                            borderColor: 'rgb(220, 53, 69)',
                            borderWidth: 2,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: `Distribuci√≥n de Citas - √çndice H = ${h}`,
                            font: { size: 16 }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.raw;
                                    if (context.datasetIndex === 0) {
                                        const position = context.dataIndex + 1;
                                        const condition = value >= position ? '‚â•' : '<';
                                        return `${label}: ${value} citas (${condition}${position})`;
                                    }
                                    return `${label}: ${value}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'N√∫mero de Citas'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Publicaciones ordenadas'
                            }
                        }
                    }
                }
            });
        }
        
        // Funci√≥n para generar citas aleatorias
        function generarCitasAleatorias() {
            const tipos = [
                [25, 12, 8, 5, 3, 1, 0, 0],  // Investigador junior
                [85, 45, 32, 25, 18, 12, 8, 5, 3, 1],  // Investigador senior
                [150, 120, 95, 80, 65, 50, 40, 30, 25, 20, 15, 12, 8, 5],  // Profesor titular
                [300, 280, 250, 220, 190, 160, 140, 120, 100, 85, 70, 60, 50, 40, 35, 30]  // Investigador principal
            ];
            
            const tipoIndex = Math.floor(Math.random() * tipos.length);
            const citas = tipos[tipoIndex];
            
            document.getElementById('citasInput').value = citas.join(', ');
            calcularIndiceH();
        }
        
        // Funci√≥n para ejecutar descenso del gradiente
        function ejecutarDescensoGradienteCompleto() {
            const funcion = document.getElementById('funcionGradiente').value;
            const x0 = parseFloat(document.getElementById('x0Grad').value);
            const alpha = parseFloat(document.getElementById('alphaGrad').value);
            const iteraciones = parseInt(document.getElementById('iterGrad').value);
            const tipo = document.getElementById('tipoGradiente').value;
            
            // Definir funci√≥n y gradiente seg√∫n selecci√≥n
            let f, grad;
            
            switch(funcion) {
                case 'quadratic':
                    f = (x) => x*x;
                    grad = (x) => 2*x;
                    break;
                case 'rosenbrock':
                    f = (x) => Math.pow(1-x, 2) + 100*Math.pow(0 - x*x, 2);
                    grad = (x) => -2*(1-x) - 400*x*(0 - x*x);
                    break;
                case 'beale':
                    f = (x) => Math.pow(1.5 - x + x*x, 2) + Math.pow(2.25 - x + x*x*x, 2) + Math.pow(2.625 - x + x*x*x*x, 2);
                    grad = (x) => {
                        return 2*(1.5 - x + x*x)*(-1 + 2*x) +
                               2*(2.25 - x + x*x*x)*(-1 + 3*x*x) +
                               2*(2.625 - x + x*x*x*x)*(-1 + 4*x*x*x);
                    };
                    break;
                case 'himmelblau':
                    f = (x) => Math.pow(x*x - 11, 2) + Math.pow(x - 7, 2);
                    grad = (x) => 4*x*(x*x - 11) + 2*(x - 7);
                    break;
                default:
                    alert('Funci√≥n no v√°lida');
                    return;
            }
            
            // Ejecutar descenso del gradiente
            let x = x0;
            const history = [{iteration: 0, x: x, f: f(x)}];
            
            for (let i = 0; i < iteraciones; i++) {
                const g = grad(x);
                
                // Aplicar diferentes tipos de descenso
                if (tipo === 'momentum') {
                    // Momentum simple (implementaci√≥n b√°sica)
                    const momentum = 0.9;
                    let velocity = 0;
                    velocity = momentum * velocity - alpha * g;
                    x = x + velocity;
                } else if (tipo === 'stochastic') {
                    // SGD con ruido
                    const noise = (Math.random() - 0.5) * 0.2;
                    const lr = alpha / (1 + 0.01 * i); // Tasa decreciente
                    x = x - lr * (g + noise);
                } else {
                    // Batch normal
                    x = x - alpha * g;
                }
                
                history.push({iteration: i+1, x: x, f: f(x)});
                
                // Verificar convergencia
                if (Math.abs(g) < 1e-6) {
                    break;
                }
            }
            
            // Mostrar resultados
            const resultadosDiv = document.getElementById('resultadosGradiente');
            resultadosDiv.innerHTML = `
                <div style="background: linear-gradient(135deg, #e6f2ff, #f0f8ff); padding: 1.5rem; border-radius: 8px;">
                    <h4 style="color: var(--azul-secundario); margin-bottom: 1rem;">üìâ Resultados del Descenso</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Punto Final</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: var(--azul-primario);">
                                ${x.toFixed(6)}
                            </div>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Valor Final</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: ${f(x) < 0.1 ? '#28a745' : '#ffc107'};">${f(x).toFixed(6)}</div>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Iteraciones</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: var(--azul-primario);">${history.length}</div>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Gradiente Final</h5>
                            <div style="font-size: 1rem; color: var(--gris-oscuro);">
                                ${grad(x).toExponential(2)}
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">üìä Evoluci√≥n del Valor</h5>
                        <div style="height: 150px; background: white; border-radius: 6px; padding: 1rem; overflow-x: auto;">
                            <div style="display: flex; height: 100%; align-items: flex-end; gap: 2px;">
                                ${history.slice(0, 50).map((h, i) => `
                                    <div style="flex: 1; background: ${i === 0 ? 'var(--azul-primario)' : i === history.length-1 ? '#28a745' : 'rgba(0, 102, 204, 0.3)'}; 
                                                height: ${Math.min(100, (h.f / Math.max(...history.map(hh => hh.f))) * 100)}%;"
                                         title="Iteraci√≥n ${h.iteration}: f=${h.f.toFixed(4)}">
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Actualizar gr√°fico
            actualizarGraficoGradienteCompleto(history, f);
        }
        
        // Funci√≥n para actualizar gr√°fico del gradiente
        function actualizarGraficoGradienteCompleto(history, f) {
            const ctx = document.getElementById('graficoGradiente').getContext('2d');
            
            // Destruir gr√°fico anterior si existe
            if (chartGradiente) {
                chartGradiente.destroy();
            }
            
            // Extraer datos
            const iterations = history.map(h => h.iteration);
            const fValues = history.map(h => h.f);
            const xValues = history.map(h => h.x);
            
            chartGradiente = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: iterations,
                    datasets: [
                        {
                            label: 'f(x)',
                            data: fValues,
                            borderColor: 'rgb(220, 53, 69)',
                            backgroundColor: 'rgba(220, 53, 69, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'x',
                            data: xValues,
                            borderColor: 'rgb(0, 102, 204)',
                            backgroundColor: 'rgba(0, 102, 204, 0.1)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.4,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Convergencia del Descenso del Gradiente'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Iteraci√≥n'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'f(x)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'x'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    }
                }
            });
        }
        
        // Funci√≥n para simular comparaci√≥n de regresi√≥n
        function simularComparacionRegresion() {
            const n = parseInt(document.getElementById('nMuestras').value);
            const d = parseInt(document.getElementById('dCaracteristicas').value);
            const ruido = parseFloat(document.getElementById('ruidoData').value);
            const condicion = parseFloat(document.getElementById('condicionNum').value);
            const metodo = document.getElementById('metodoOptim').value;
            
            // Simular resultados
            const resultados = [];
            
            if (metodo === 'comparar' || metodo === 'pseudoinverso') {
                resultados.push({
                    metodo: 'Pseudoinverso',
                    mse: (0.5 + Math.random() * 2).toFixed(4),
                    tiempo: (0.001 + Math.random() * 0.005).toFixed(4),
                    iteraciones: '1',
                    memoria: 'Alta',
                    estabilidad: condicion < 1000 ? 'Alta' : 'Media'
                });
            }
            
            if (metodo === 'comparar' || metodo === 'gradiente') {
                resultados.push({
                    metodo: 'Descenso Gradiente',
                    mse: (0.6 + Math.random() * 2.5).toFixed(4),
                    tiempo: (0.01 + Math.random() * 0.05).toFixed(4),
                    iteraciones: Math.floor(100 + Math.random() * 900),
                    memoria: 'Baja',
                    estabilidad: 'Alta'
                });
                
                resultados.push({
                    metodo: 'SGD',
                    mse: (0.7 + Math.random() * 3).toFixed(4),
                    tiempo: (0.005 + Math.random() * 0.03).toFixed(4),
                    iteraciones: Math.floor(50 + Math.random() * 150),
                    memoria: 'Muy Baja',
                    estabilidad: 'Media'
                });
            }
            
            // Mostrar resultados
            const resultadosDiv = document.getElementById('resultadosComparacion');
            resultadosDiv.innerHTML = `
                <div style="background: linear-gradient(135deg, #e6f2ff, #f0f8ff); padding: 1.5rem; border-radius: 8px;">
                    <h4 style="color: var(--azul-secundario); margin-bottom: 1rem;">üìä Resultados Comparativos</h4>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>M√©todo</th>
                                    <th>MSE</th>
                                    <th>Tiempo (s)</th>
                                    <th>Iteraciones</th>
                                    <th>Memoria</th>
                                    <th>Estabilidad</th>
                                    <th>Recomendaci√≥n</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${resultados.map(r => `
                                    <tr>
                                        <td><strong>${r.metodo}</strong></td>
                                        <td>${r.mse}</td>
                                        <td>${r.tiempo}</td>
                                        <td>${r.iteraciones}</td>
                                        <td>${r.memoria}</td>
                                        <td>${r.estabilidad}</td>
                                        <td>
                                            ${r.metodo === 'Pseudoinverso' && n < 10000 && d < 100 ? '‚úÖ Ideal' : 
                                              r.metodo === 'Descenso Gradiente' && n > 1000 ? '‚úÖ Recomendado' :
                                              r.metodo === 'SGD' && n > 10000 ? '‚úÖ Escalable' : '‚ö†Ô∏è Evaluar'}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="margin-top: 1.5rem; padding: 1rem; background: white; border-radius: 6px;">
                        <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">üéØ Conclusi√≥n para este caso:</h5>
                        <p>
                            Para $n=${n}$, $d=${d}$, $\kappa=${condicion.toFixed(0)}$:
                            ${n < 1000 ? 'El <strong>Pseudoinverso</strong> es la mejor opci√≥n por exactitud.' :
                              n < 10000 ? 'El <strong>Descenso de Gradiente</strong> ofrece buen balance.' :
                              'El <strong>SGD</strong> es necesario por escalabilidad.'}
                        </p>
                        <div class="formula" style="margin-top: 1rem;">
                            <strong>F√≥rmula recomendada:</strong><br>
                            $$ w_{final} = 0.7 \cdot w_{MP} + 0.3 \cdot w_{GD} $$
                            <small>Combinaci√≥n √≥ptima para exactitud y robustez</small>
                        </div>
                    </div>
                </div>
            `;
            
            // Actualizar gr√°fico de comparaci√≥n
            actualizarGraficoComparacion(resultados);
        }
        
        // Funci√≥n para actualizar gr√°fico de comparaci√≥n
        function actualizarGraficoComparacion(resultados) {
            const ctx = document.getElementById('graficoComparacion').getContext('2d');
            
            // Destruir gr√°fico anterior si existe
            if (chartComparacion) {
                chartComparacion.destroy();
            }
            
            chartComparacion = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: resultados.map(r => r.metodo),
                    datasets: [
                        {
                            label: 'MSE (Error)',
                            data: resultados.map(r => parseFloat(r.mse)),
                            backgroundColor: 'rgba(220, 53, 69, 0.7)',
                            borderColor: 'rgb(220, 53, 69)',
                            borderWidth: 1
                        },
                        {
                            label: 'Tiempo (s)',
                            data: resultados.map(r => parseFloat(r.tiempo) * 100), // Escalado para visualizaci√≥n
                            backgroundColor: 'rgba(0, 102, 204, 0.7)',
                            borderColor: 'rgb(0, 102, 204)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Comparaci√≥n de M√©todos de Regresi√≥n'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label === 'Tiempo (s)') {
                                        return `${label}: ${(context.raw / 100).toFixed(4)}s`;
                                    }
                                    return `${label}: ${context.raw}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'MSE / Tiempo (s √ó 100)'
                            }
                        }
                    }
                }
            });
        }
        
        // Funci√≥n para simulaci√≥n de caramelos
        function ejecutarSimulacionCaramelos() {
            const estudiantes = parseInt(document.getElementById('numEstudiantes').value);
            const caramelosPorEst = parseInt(document.getElementById('caramelosxEst').value);
            const metaChupetines = parseInt(document.getElementById('metaChupetines').value);
            const rondasMax = parseInt(document.getElementById('rondasMax').value);
            
            // Simulaci√≥n b√°sica
            let grupo1Chupetines = 0;
            let grupo2Chupetines = 0;
            let ronda = 0;
            const historial = [];
            
            for (ronda = 0; ronda < rondasMax; ronda++) {
                // Simular intercambios aleatorios
                const incremento1 = Math.floor(Math.random() * 3);
                const incremento2 = Math.floor(Math.random() * 3);
                
                grupo1Chupetines += incremento1;
                grupo2Chupetines += incremento2;
                
                historial.push({
                    ronda: ronda + 1,
                    grupo1: grupo1Chupetines,
                    grupo2: grupo2Chupetines
                });
                
                // Verificar si alg√∫n grupo gan√≥
                if (grupo1Chupetines >= metaChupetines || grupo2Chupetines >= metaChupetines) {
                    break;
                }
            }
            
            // Determinar ganador
            let ganador = '';
            if (grupo1Chupetines >= metaChupetines && grupo2Chupetines >= metaChupetines) {
                ganador = 'Empate';
            } else if (grupo1Chupetines >= metaChupetines) {
                ganador = 'Grupo 1';
            } else if (grupo2Chupetines >= metaChupetines) {
                ganador = 'Grupo 2';
            } else {
                ganador = 'Ninguno (rondas m√°ximas alcanzadas)';
            }
            
            // Mostrar resultados
            const resultadosDiv = document.getElementById('resultadosCaramelos');
            resultadosDiv.innerHTML = `
                <div style="background: linear-gradient(135deg, #e6f2ff, #f0f8ff); padding: 1.5rem; border-radius: 8px;">
                    <h4 style="color: var(--azul-secundario); margin-bottom: 1rem;">üç¨ Resultados de la Simulaci√≥n</h4>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">üèÜ Ganador</h5>
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--azul-primario);">${ganador}</div>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Grupo 1</h5>
                            <div style="font-size: 2rem; font-weight: bold; color: #dc3545;">${grupo1Chupetines}</div>
                            <small>chupetines</small>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Grupo 2</h5>
                            <div style="font-size: 2rem; font-weight: bold; color: #28a745;">${grupo2Chupetines}</div>
                            <small>chupetines</small>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Rondas</h5>
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--azul-primario);">${ronda + 1}</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">üìä Progreso por Ronda</h5>
                        <div style="height: 200px; overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: var(--gris-claro);">
                                        <th style="padding: 0.5rem; text-align: center;">Ronda</th>
                                        <th style="padding: 0.5rem; text-align: center;">Grupo 1</th>
                                        <th style="padding: 0.5rem; text-align: center;">Grupo 2</th>
                                        <th style="padding: 0.5rem; text-align: center;">Diferencia</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${historial.map(h => `
                                        <tr style="border-bottom: 1px solid var(--gris-claro);">
                                            <td style="padding: 0.5rem; text-align: center;">${h.ronda}</td>
                                            <td style="padding: 0.5rem; text-align: center; color: ${h.grupo1 > h.grupo2 ? '#dc3545' : 'inherit'}">${h.grupo1}</td>
                                            <td style="padding: 0.5rem; text-align: center; color: ${h.grupo2 > h.grupo1 ? '#28a745' : 'inherit'}">${h.grupo2}</td>
                                            <td style="padding: 0.5rem; text-align: center;">${Math.abs(h.grupo1 - h.grupo2)}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
            
            // Actualizar gr√°fico
            actualizarGraficoCaramelos(historial);
        }
        
        // Funci√≥n para actualizar gr√°fico de caramelos
        function actualizarGraficoCaramelos(historial) {
            const ctx = document.getElementById('graficoCaramelos').getContext('2d');
            
            // Destruir gr√°fico anterior si existe
            if (chartCaramelos) {
                chartCaramelos.destroy();
            }
            
            chartCaramelos = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: historial.map(h => h.ronda),
                    datasets: [
                        {
                            label: 'Grupo 1',
                            data: historial.map(h => h.grupo1),
                            borderColor: 'rgb(220, 53, 69)',
                            backgroundColor: 'rgba(220, 53, 69, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Grupo 2',
                            data: historial.map(h => h.grupo2),
                            borderColor: 'rgb(40, 167, 69)',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Progreso de Chupetines por Grupo'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Ronda'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Chupetines'
                            }
                        }
                    }
                }
            });
        }
        
        // Funci√≥n para calcular derivada num√©rica
        function calcularDerivadaNumerica() {
            const funcionStr = document.getElementById('funcDif').value;
            const x = parseFloat(document.getElementById('puntoDif').value);
            const h = parseFloat(document.getElementById('hDif').value);
            const tipo = document.getElementById('tipoDif').value;
            
            // Definir funci√≥n
            let f;
            try {
                // Crear funci√≥n a partir del string (simplificado)
                f = (xVal) => {
                    // Reemplazar x por el valor
                    const expr = funcionStr.replace(/x/g, `(${xVal})`);
                    // Evaluar expresi√≥n (¬°CUIDADO! En producci√≥n usar un parser seguro)
                    return eval(expr);
                };
                
                // Test de la funci√≥n
                f(1);
            } catch (error) {
                alert('Error en la funci√≥n. Usa formato como: x^2, sin(x), exp(x), etc.');
                return;
            }
            
            // Calcular derivada seg√∫n tipo
            let derivada, valorExacto, error;
            
            switch(tipo) {
                case 'forward':
                    derivada = (f(x + h) - f(x)) / h;
                    break;
                case 'backward':
                    derivada = (f(x) - f(x - h)) / h;
                    break;
                case 'central':
                    derivada = (f(x + h) - f(x - h)) / (2 * h);
                    break;
                case 'second':
                    derivada = (f(x + h) - 2*f(x) + f(x - h)) / (h * h);
                    break;
                default:
                    derivada = 0;
            }
            
            // Para funci√≥n conocida x^2, calcular valor exacto
            if (funcionStr === 'x^2') {
                if (tipo === 'second') {
                    valorExacto = 2; // Segunda derivada de x^2 es 2
                } else {
                    valorExacto = 2 * x; // Primera derivada de x^2 es 2x
                }
                error = Math.abs(derivada - valorExacto);
            } else {
                valorExacto = null;
                error = null;
            }
            
            // Mostrar resultados
            const resultadosDiv = document.getElementById('resultadosDiferenciacion');
            resultadosDiv.innerHTML = `
                <div style="background: linear-gradient(135deg, #e6f2ff, #f0f8ff); padding: 1.5rem; border-radius: 8px;">
                    <h4 style="color: var(--azul-secundario); margin-bottom: 1rem;">üßÆ Resultados de Diferenciaci√≥n Num√©rica</h4>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Funci√≥n</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: var(--azul-primario);">f(x) = ${funcionStr}</div>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Punto x</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: var(--azul-primario);">${x}</div>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Tama√±o h</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: var(--azul-primario);">${h}</div>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Derivada Aproximada</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: #28a745;">${derivada.toFixed(6)}</div>
                            <small>M√©todo: ${tipo === 'forward' ? 'Adelante' : tipo === 'backward' ? 'Atr√°s' : tipo === 'central' ? 'Centrada' : 'Segunda'}</small>
                        </div>
                    </div>
                    
                    ${valorExacto !== null ? `
                    <div style="margin-top: 1.5rem; padding: 1rem; background: white; border-radius: 6px;">
                        <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">üìä Comparaci√≥n con Valor Exacto</h5>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div style="flex: 1;">
                                <div style="font-size: 0.9rem; color: var(--gris-medio);">Valor Exacto</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: var(--azul-primario);">${valorExacto.toFixed(6)}</div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 0.9rem; color: var(--gris-medio);">Error Absoluto</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: ${error < 0.1 ? '#28a745' : error < 1 ? '#ffc107' : '#dc3545'};">${error.toFixed(6)}</div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 0.9rem; color: var(--gris-medio);">Error Relativo</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: ${error/valorExacto < 0.01 ? '#28a745' : error/valorExacto < 0.1 ? '#ffc107' : '#dc3545'};">${(error/Math.abs(valorExacto)*100).toFixed(2)}%</div>
                            </div>
                        </div>
                    </div>
                    ` : ''}
                    
                    <div style="margin-top: 1.5rem;">
                        <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">üí° Interpretaci√≥n</h5>
                        <p>
                            ${tipo === 'second' ? 
                                'La segunda derivada mide la <strong>concavidad</strong> de la funci√≥n.' :
                                'La derivada mide la <strong>tasa de cambio</strong> de la funci√≥n en el punto x.'}
                            <br>
                            ${h < 0.1 ? 'Con h peque√±o, la aproximaci√≥n es m√°s precisa.' : 
                              h < 1 ? 'Con h moderado, hay buen balance entre precisi√≥n y estabilidad.' :
                              'Con h grande, la aproximaci√≥n puede ser menos precisa.'}
                        </p>
                    </div>
                </div>
            `;
            
            // Actualizar gr√°fico
            actualizarGraficoDiferenciacion(f, x, h, tipo);
        }
        
        // Funci√≥n para actualizar gr√°fico de diferenciaci√≥n
        function actualizarGraficoDiferenciacion(f, x, h, tipo) {
            const ctx = document.getElementById('graficoDiferenciacion').getContext('2d');
            
            // Destruir gr√°fico anterior si existe
            if (chartDiferenciacion) {
                chartDiferenciacion.destroy();
            }
            
            // Crear puntos para la funci√≥n
            const xMin = x - 3*h;
            const xMax = x + 3*h;
            const step = (xMax - xMin) / 100;
            
            const puntosX = [];
            const puntosY = [];
            
            for (let i = 0; i <= 100; i++) {
                const xi = xMin + i * step;
                puntosX.push(xi);
                try {
                    puntosY.push(f(xi));
                } catch {
                    puntosY.push(null);
                }
            }
            
            // Calcular puntos para la recta tangente (si es primera derivada)
            let rectaX = [], rectaY = [];
            if (tipo !== 'second') {
                const derivada = tipo === 'forward' ? (f(x + h) - f(x)) / h :
                                tipo === 'backward' ? (f(x) - f(x - h)) / h :
                                (f(x + h) - f(x - h)) / (2 * h);
                
                const y0 = f(x);
                for (let i = 0; i <= 10; i++) {
                    const xi = x - h + i * (2*h/10);
                    rectaX.push(xi);
                    rectaY.push(y0 + derivada * (xi - x));
                }
            }
            
            chartDiferenciacion = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'f(x)',
                            data: puntosX.map((xi, i) => ({x: xi, y: puntosY[i]})),
                            borderColor: 'rgb(0, 102, 204)',
                            backgroundColor: 'rgba(0, 102, 204, 0.1)',
                            borderWidth: 2,
                            showLine: true,
                            fill: false,
                            pointRadius: 0
                        },
                        {
                            label: 'Punto de inter√©s',
                            data: [{x: x, y: f(x)}],
                            backgroundColor: 'rgb(220, 53, 69)',
                            borderColor: 'rgb(220, 53, 69)',
                            borderWidth: 2,
                            pointRadius: 6
                        },
                        {
                            label: tipo === 'second' ? 'Puntos usados' : 'Recta tangente',
                            data: tipo === 'second' ? 
                                [{x: x-h, y: f(x-h)}, {x: x, y: f(x)}, {x: x+h, y: f(x+h)}] :
                                rectaX.map((xi, i) => ({x: xi, y: rectaY[i]})),
                            borderColor: tipo === 'second' ? 'rgb(40, 167, 69)' : 'rgb(255, 193, 7)',
                            backgroundColor: tipo === 'second' ? 'rgba(40, 167, 69, 0.5)' : 'rgba(255, 193, 7, 0.1)',
                            borderWidth: 2,
                            showLine: tipo !== 'second',
                            fill: false,
                            pointRadius: tipo === 'second' ? 4 : 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: tipo === 'second' ? 
                                'Aproximaci√≥n de la Segunda Derivada' :
                                'Aproximaci√≥n de la Derivada'
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'x'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'f(x)'
                            }
                        }
                    }
                }
            });
        }
        
        // Funci√≥n para simulaci√≥n de Markov
        function ejecutarSimulacionMarkov() {
            const tipo = document.getElementById('tipoCadena').value;
            const pasos = parseInt(document.getElementById('pasosMarkov').value);
            const estadoInicial = parseInt(document.getElementById('estadoInicial').value);
            const numSimulaciones = parseInt(document.getElementById('simulacionesMarkov').value);
            
            // Definir matriz de transici√≥n seg√∫n tipo
            let P, estados, estadoActual;
            
            switch(tipo) {
                case 'clima':
                    P = [
                        [0.6, 0.3, 0.1],  // Soleado -> S, N, L
                        [0.4, 0.4, 0.2],  // Nublado -> S, N, L
                        [0.2, 0.3, 0.5]   // Lluvioso -> S, N, L
                    ];
                    estados = ['Soleado', 'Nublado', 'Lluvioso'];
                    break;
                case 'finanzas':
                    P = [
                        [0.7, 0.2, 0.1],  // Alza -> A, E, B
                        [0.3, 0.4, 0.3],  // Estable -> A, E, B
                        [0.1, 0.3, 0.6]   // Baja -> A, E, B
                    ];
                    estados = ['Alza', 'Estable', 'Baja'];
                    break;
                case 'salud':
                    P = [
                        [0.8, 0.2, 0.0],  // Sano -> S, E, R
                        [0.1, 0.6, 0.3],  // Enfermo -> S, E, R
                        [0.0, 0.0, 1.0]   // Recuperado -> S, E, R (absorbente)
                    ];
                    estados = ['Sano', 'Enfermo', 'Recuperado'];
                    break;
                default:
                    // Personalizado
                    P = [
                        [0.5, 0.3, 0.2],
                        [0.2, 0.6, 0.2],
                        [0.1, 0.4, 0.5]
                    ];
                    estados = ['Estado 0', 'Estado 1', 'Estado 2'];
            }
            
            // Validar estado inicial
            estadoActual = Math.min(Math.max(estadoInicial, 0), estados.length - 1);
            
            // Realizar simulaciones
            const historialEstados = [];
            const frecuencias = new Array(estados.length).fill(0);
            
            for (let i = 0; i < pasos; i++) {
                historialEstados.push(estadoActual);
                frecuencias[estadoActual]++;
                
                // Transici√≥n al siguiente estado
                const r = Math.random();
                let acumulado = 0;
                let nuevoEstado = estadoActual;
                
                for (let j = 0; j < estados.length; j++) {
                    acumulado += P[estadoActual][j];
                    if (r < acumulado) {
                        nuevoEstado = j;
                        break;
                    }
                }
                
                estadoActual = nuevoEstado;
            }
            
            // Calcular probabilidades estimadas
            const probsEstimadas = frecuencias.map(f => f / pasos);
            
            // Calcular estado estable te√≥rico (soluci√≥n de œÄP = œÄ)
            // Para matriz 3x3 simple
            let pi;
            if (tipo === 'clima') {
                pi = [0.44, 0.33, 0.23]; // Estado estable conocido
            } else {
                // Aproximaci√≥n simple
                pi = probsEstimadas.map(p => p);
            }
            
            // Mostrar resultados
            const resultadosDiv = document.getElementById('resultadosMarkov');
            resultadosDiv.innerHTML = `
                <div style="background: linear-gradient(135deg, #e6f2ff, #f0f8ff); padding: 1.5rem; border-radius: 8px;">
                    <h4 style="color: var(--azul-secundario); margin-bottom: 1rem;">üîÑ Resultados de la Cadena de Markov</h4>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Tipo</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: var(--azul-primario);">
                                ${tipo === 'clima' ? 'Clima' : tipo === 'finanzas' ? 'Finanzas' : tipo === 'salud' ? 'Salud' : 'Personalizado'}
                            </div>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Estado Inicial</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: var(--azul-primario);">
                                ${estados[estadoInicial]}
                            </div>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Pasos</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: var(--azul-primario);">${pasos}</div>
                        </div>
                        
                        <div style="background: white; padding: 1rem; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">Estado Final</h5>
                            <div style="font-size: 1.2rem; font-weight: bold; color: #28a745;">
                                ${estados[estadoActual]}
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">üìä Distribuci√≥n de Estados</h5>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.5rem;">
                            ${estados.map((estado, i) => `
                                <div style="background: white; padding: 0.8rem; border-radius: 6px; border-left: 4px solid var(--azul-primario);">
                                    <div style="font-weight: bold; color: var(--gris-oscuro);">${estado}</div>
                                    <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                                        <span style="font-size: 0.9rem; color: var(--gris-medio);">Frecuencia:</span>
                                        <span style="font-weight: bold; color: var(--azul-primario);">${frecuencias[i]}</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between;">
                                        <span style="font-size: 0.9rem; color: var(--gris-medio);">Probabilidad:</span>
                                        <span style="font-weight: bold; color: #28a745;">${(frecuencias[i]/pasos*100).toFixed(1)}%</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem; padding: 1rem; background: white; border-radius: 6px;">
                        <h5 style="color: var(--gris-medio); margin-bottom: 0.5rem;">üéØ Estado Estable Te√≥rico</h5>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.5rem;">
                            ${estados.map((estado, i) => `
                                <div style="text-align: center;">
                                    <div style="font-size: 0.9rem; color: var(--gris-medio);">${estado}</div>
                                    <div style="font-size: 1.2rem; font-weight: bold; color: #dc3545;">${(pi[i]*100).toFixed(1)}%</div>
                                </div>
                            `).join('')}
                        </div>
                        <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--gris-medio);">
                            El estado estable representa la distribuci√≥n de probabilidad a largo plazo.
                        </p>
                    </div>
                </div>
            `;
            
            // Actualizar gr√°fico
            actualizarGraficoMarkov(historialEstados, estados);
        }
        
        // Funci√≥n para actualizar gr√°fico de Markov
        function actualizarGraficoMarkov(historialEstados, estados) {
            const ctx = document.getElementById('graficoMarkov').getContext('2d');
            
            // Destruir gr√°fico anterior si existe
            if (chartMarkov) {
                chartMarkov.destroy();
            }
            
            // Contar transiciones entre estados
            const transiciones = {};
            for (let i = 0; i < historialEstados.length - 1; i++) {
                const de = historialEstados[i];
                const a = historialEstados[i + 1];
                const key = `${de}-${a}`;
                transiciones[key] = (transiciones[key] || 0) + 1;
            }
            
            // Preparar datos para gr√°fico de transiciones
            const labels = [];
            const data = [];
            const backgroundColors = [];
            
            estados.forEach((estadoDe, i) => {
                estados.forEach((estadoA, j) => {
                    const key = `${i}-${j}`;
                    const count = transiciones[key] || 0;
                    if (count > 0) {
                        labels.push(`${estadoDe} ‚Üí ${estadoA}`);
                        data.push(count);
                        // Color basado en la frecuencia
                        const intensity = Math.min(255, 100 + count * 50);
                        backgroundColors.push(`rgba(${i*80}, ${j*80}, 200, 0.7)`);
                    }
                });
            });
            
            chartMarkov = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'N√∫mero de Transiciones',
                        data: data,
                        backgroundColor: backgroundColors,
                        borderColor: backgroundColors.map(c => c.replace('0.7', '1')),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Transiciones entre Estados'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'N√∫mero de Transiciones'
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45
                            }
                        }
                    }
                }
            });
        }
        
        // Funci√≥n para copiar c√≥digo
        function copiarCodigo(elementId) {
            const codeElement = document.getElementById(elementId);
            const code = codeElement.textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                // Mostrar mensaje de confirmaci√≥n
                const originalText = event.target.textContent;
                event.target.textContent = '¬°Copiado!';
                event.target.style.backgroundColor = '#28a745';
                
                setTimeout(() => {
                    event.target.textContent = originalText;
                    event.target.style.backgroundColor = '';
                }, 2000);
            }).catch(err => {
                console.error('Error al copiar: ', err);
                alert('Error al copiar el c√≥digo');
            });
        }
        
        // Funci√≥n para descargar c√≥digo
        function descargarCodigo(tipo) {
            const codigos = {
                biseccion: `# M√©todo de Bisecci√≥n
def biseccion(f, a, b, tol=1e-6, max_iter=100):
    if f(a) * f(b) >= 0:
        raise ValueError("La funci√≥n debe cambiar de signo en el intervalo")
    
    for i in range(max_iter):
        c = (a + b) / 2
        if abs(f(c)) < tol or (b - a) / 2 < tol:
            return c, i
        if f(c) * f(a) < 0:
            b = c
        else:
            a = c
    return c, max_iter`,
                
                h_index: `# C√°lculo del √çndice H
def calcular_indice_h(citas):
    citas_ordenadas = sorted(citas, reverse=True)
    h = 0
    for i, c in enumerate(citas_ordenadas, 1):
        if c >= i:
            h = i
        else:
            break
    return h`,
                
                caramelos: `# Simulaci√≥n del Juego de Caramelos
simular_caramelos <- function(n_estudiantes=9, n_rondas=20) {
  resultados <- data.frame()
  for (ronda in 1:n_rondas) {
    # L√≥gica de simulaci√≥n
    resultados <- rbind(resultados, data.frame(ronda=ronda))
  }
  return(resultados)
}`,
                
                diferenciacion: `# Diferenciaci√≥n Num√©rica
def derivada_numerica(f, x, h=0.001, metodo='central'):
    if metodo == 'adelante':
        return (f(x + h) - f(x)) / h
    elif metodo == 'atras':
        return (f(x) - f(x - h)) / h
    elif metodo == 'central':
        return (f(x + h) - f(x - h)) / (2 * h)
    elif metodo == 'segunda':
        return (f(x + h) - 2*f(x) + f(x - h)) / (h * h)`,
                
                papa: `# An√°lisis de Producci√≥n de Papa
produccion <- c(1492.7, 1767.2, 2368.4, 2308.9, 2398.1, 2589.3,
                3066.2, 3273.8, 2680.1, 3300.3, 3151.2, 3008.2,
                3289.7, 3248.4, 3383.0, 3597.1, 3765.3, 3805.5,
                4072.5, 4474.7, 4569.6, 4705.0, 4715.9, 4514.2,
                4802.8, 5133.9, 5389.2, 5515.4, 5702.3, 6040.8,
                5456.5, 6587.0)`,
                
                markov: `# Simulaci√≥n de Cadena de Markov
import numpy as np

def simular_markov(P, estado_inicial, n_pasos):
    estados = [estado_inicial]
    for _ in range(n_pasos):
        estado_actual = estados[-1]
        siguiente = np.random.choice(len(P), p=P[estado_actual])
        estados.append(siguiente)
    return estados`
            };
            
            if (codigos[tipo]) {
                const blob = new Blob([codigos[tipo]], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${tipo}.${tipo === 'caramelos' || tipo === 'papa' ? 'R' : 'py'}`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        }
        
        // Funciones de utilidad adicionales
        function calcularIndiceHAvanzado() {
            alert('Calculadora avanzada de √çndice H - Implementaci√≥n extendida disponible');
            calcularIndiceH();
        }
        
        function analizarTendencia() {
            alert('An√°lisis de tendencia - Implementaci√≥n extendida disponible');
        }
        
        function analisisProbabilistico() {
            alert('An√°lisis probabil√≠stico - Implementaci√≥n extendida disponible');
        }
        
        function simulacionMultiple() {
            alert('Simulaci√≥n m√∫ltiple - Implementaci√≥n extendida disponible');
        }
        
        function simularRegistroDemons() {
            alert('Simulaci√≥n de registro Demons - Implementaci√≥n extendida disponible');
        }
        
        function simularInterpolacion() {
            alert('Simulaci√≥n de interpolaci√≥n - Implementaci√≥n extendida disponible');
        }
        
        function simularPruebasJMeter() {
            alert('Simulaci√≥n de pruebas JMeter - Implementaci√≥n extendida disponible');
        }
        
        function calcularEigenvalores() {
            alert('C√°lculo de eigenvalores - Implementaci√≥n extendida disponible');
        }
        
        function mostrarResumenUnidad() {
            alert('Resumen de la unidad mostrado');
        }
        
        function generarLibroPDF() {
            alert('Generando libro PDF... Esta funci√≥n requiere backend.');
        }
        
        // Inicializar con el men√∫
        showActivity('menu');
    </script>
</body>
</html>

